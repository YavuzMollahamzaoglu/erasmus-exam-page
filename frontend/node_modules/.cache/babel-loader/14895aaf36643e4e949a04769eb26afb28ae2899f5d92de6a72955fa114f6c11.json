{"ast":null,"code":"export function installAuthFetchInterceptor(onExpired) {\n  if (typeof window === 'undefined') return;\n  const w = window;\n  if (w.__authFetchInstalled) return;\n  const originalFetch = window.fetch.bind(window);\n  window.fetch = async (input, init) => {\n    try {\n      const url = typeof input === 'string' ? input : input.url || String(input);\n      const isApiCall = url.startsWith('http://localhost:4000');\n      const headers = new Headers((init === null || init === void 0 ? void 0 : init.headers) || {});\n      let attachedAuth = false;\n      if (isApiCall) {\n        const jwt = localStorage.getItem('token');\n        if (jwt && !headers.has('Authorization')) {\n          headers.set('Authorization', `Bearer ${jwt}`);\n          attachedAuth = true;\n        } else if (headers.has('Authorization')) {\n          attachedAuth = true;\n        }\n      }\n      const resp = await originalFetch(input, {\n        ...init,\n        headers\n      });\n      if (isApiCall && attachedAuth && (resp.status === 401 || resp.status === 403)) {\n        try {\n          onExpired === null || onExpired === void 0 ? void 0 : onExpired();\n        } catch {}\n      }\n      return resp;\n    } catch (e) {\n      // In case of wrapping error, fallback to original fetch\n      return originalFetch(input, init);\n    }\n  };\n  w.__authFetchInstalled = true;\n}","map":{"version":3,"names":["installAuthFetchInterceptor","onExpired","window","w","__authFetchInstalled","originalFetch","fetch","bind","input","init","url","String","isApiCall","startsWith","headers","Headers","attachedAuth","jwt","localStorage","getItem","has","set","resp","status","e"],"sources":["/Users/yavuz/Desktop/portfolio/erasmus-exam-page/frontend/src/utils/installAuthFetchInterceptor.ts"],"sourcesContent":["export function installAuthFetchInterceptor(onExpired: () => void) {\n  if (typeof window === 'undefined') return;\n  const w = window as any;\n  if (w.__authFetchInstalled) return;\n  const originalFetch = window.fetch.bind(window);\n  window.fetch = async (input: RequestInfo | URL, init?: RequestInit) => {\n    try {\n      const url = typeof input === 'string' ? input : (input as any).url || String(input);\n      const isApiCall = url.startsWith('http://localhost:4000');\n      const headers = new Headers(init?.headers || {});\n      let attachedAuth = false;\n      if (isApiCall) {\n        const jwt = localStorage.getItem('token');\n        if (jwt && !headers.has('Authorization')) {\n          headers.set('Authorization', `Bearer ${jwt}`);\n          attachedAuth = true;\n        } else if (headers.has('Authorization')) {\n          attachedAuth = true;\n        }\n      }\n      const resp = await originalFetch(input, { ...init, headers });\n      if (isApiCall && attachedAuth && (resp.status === 401 || resp.status === 403)) {\n        try { onExpired?.(); } catch {}\n      }\n      return resp;\n    } catch (e) {\n      // In case of wrapping error, fallback to original fetch\n      return originalFetch(input, init);\n    }\n  };\n  w.__authFetchInstalled = true;\n}\n"],"mappings":"AAAA,OAAO,SAASA,2BAA2BA,CAACC,SAAqB,EAAE;EACjE,IAAI,OAAOC,MAAM,KAAK,WAAW,EAAE;EACnC,MAAMC,CAAC,GAAGD,MAAa;EACvB,IAAIC,CAAC,CAACC,oBAAoB,EAAE;EAC5B,MAAMC,aAAa,GAAGH,MAAM,CAACI,KAAK,CAACC,IAAI,CAACL,MAAM,CAAC;EAC/CA,MAAM,CAACI,KAAK,GAAG,OAAOE,KAAwB,EAAEC,IAAkB,KAAK;IACrE,IAAI;MACF,MAAMC,GAAG,GAAG,OAAOF,KAAK,KAAK,QAAQ,GAAGA,KAAK,GAAIA,KAAK,CAASE,GAAG,IAAIC,MAAM,CAACH,KAAK,CAAC;MACnF,MAAMI,SAAS,GAAGF,GAAG,CAACG,UAAU,CAAC,uBAAuB,CAAC;MACzD,MAAMC,OAAO,GAAG,IAAIC,OAAO,CAAC,CAAAN,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEK,OAAO,KAAI,CAAC,CAAC,CAAC;MAChD,IAAIE,YAAY,GAAG,KAAK;MACxB,IAAIJ,SAAS,EAAE;QACb,MAAMK,GAAG,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;QACzC,IAAIF,GAAG,IAAI,CAACH,OAAO,CAACM,GAAG,CAAC,eAAe,CAAC,EAAE;UACxCN,OAAO,CAACO,GAAG,CAAC,eAAe,EAAE,UAAUJ,GAAG,EAAE,CAAC;UAC7CD,YAAY,GAAG,IAAI;QACrB,CAAC,MAAM,IAAIF,OAAO,CAACM,GAAG,CAAC,eAAe,CAAC,EAAE;UACvCJ,YAAY,GAAG,IAAI;QACrB;MACF;MACA,MAAMM,IAAI,GAAG,MAAMjB,aAAa,CAACG,KAAK,EAAE;QAAE,GAAGC,IAAI;QAAEK;MAAQ,CAAC,CAAC;MAC7D,IAAIF,SAAS,IAAII,YAAY,KAAKM,IAAI,CAACC,MAAM,KAAK,GAAG,IAAID,IAAI,CAACC,MAAM,KAAK,GAAG,CAAC,EAAE;QAC7E,IAAI;UAAEtB,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAG,CAAC;QAAE,CAAC,CAAC,MAAM,CAAC;MAChC;MACA,OAAOqB,IAAI;IACb,CAAC,CAAC,OAAOE,CAAC,EAAE;MACV;MACA,OAAOnB,aAAa,CAACG,KAAK,EAAEC,IAAI,CAAC;IACnC;EACF,CAAC;EACDN,CAAC,CAACC,oBAAoB,GAAG,IAAI;AAC/B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}