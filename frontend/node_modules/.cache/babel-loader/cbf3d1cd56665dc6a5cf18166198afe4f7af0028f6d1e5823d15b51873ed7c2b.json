{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useLocation}from'react-router-dom';import{Box,Paper,Typography,Button,Collapse,Chip,Select,MenuItem,Dialog,DialogTitle,DialogContent,IconButton,FormControl,InputLabel,Tooltip}from'@mui/material';import CloseIcon from'@mui/icons-material/Close';import CheckCircleIcon from'@mui/icons-material/CheckCircle';import CancelIcon from'@mui/icons-material/Cancel';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const palette={bg:'#b2dfdb',card:'#fff',accent:'#1976d2',correct:'#43a047',wrong:'#e53935',gray:'#e3eafc'};const History=_ref=>{let{token}=_ref;// Redirect in effect to keep hooks order intact\nuseEffect(()=>{if(typeof window!=='undefined'&&(!token||!localStorage.getItem('token'))){window.location.href='/login?session=expired';}},[token]);const[history,setHistory]=useState([]);const[allHistory,setAllHistory]=useState([]);const[expanded,setExpanded]=useState(null);const[questionDialog,setQuestionDialog]=useState(null);const[loading,setLoading]=useState(false);const[filter,setFilter]=useState('all');const[sort,setSort]=useState('desc');const[categoryTypeFilter,setCategoryTypeFilter]=useState('all');const location=useLocation();// Helpers\nfunction getExamCategoryType(exam){const title=(exam.title||exam.examTitle||'').toString().toLowerCase();const catName=(exam.categoryName||exam.category||'').toString().toLowerCase();const s=`${title} ${catName}`;if(s.includes('erasmus'))return'ERASMUS';if(s.includes('genel')||s.includes('general'))return'GENEL';if(s.includes('hazÄ±rlÄ±k')||s.includes('hazirlik'))return'HAZIRLIK';return null;}function matchCategory(exam,value){if(value==='all')return true;const title=(exam.title||exam.examTitle||'').toString().toUpperCase();const cat=(exam.category||exam.categoryName||exam.level||'').toString().toUpperCase();return title.includes(value.toUpperCase())||cat===value.toUpperCase();}function getDateValue(exam){const d=exam.date||exam.completedAt||exam.createdAt;const dt=d?new Date(d):null;return dt?dt.getTime():0;}function applyFilters(source){let list=source;// Level (A1/A2/B1/B2)\nif(filter!=='all')list=list.filter(exam=>matchCategory(exam,filter));// Category type (Erasmus/Genel/HazÄ±rlÄ±k)\nif(categoryTypeFilter!=='all'){const want=categoryTypeFilter.toUpperCase();list=list.filter(exam=>getExamCategoryType(exam)===(want==='GENEL Ä°NGÄ°LÄ°ZCE'?'GENEL':want));}// Sort by date\nlist=[...list].sort((a,b)=>getDateValue(b)-getDateValue(a));if(sort==='asc')list.reverse();setHistory(list);}// Initial load + parse URL filters\nuseEffect(()=>{if(!token)return;// defensive: avoid fetching without token\nsetLoading(true);const params=new URLSearchParams(location.search);const qCategoryLegacy=params.get('category');const qLevel=params.get('level');const qCatType=params.get('cat');// Backward compat: category=A1|A2.. used as level; if it's a known type, map accordingly\nif(qLevel)setFilter(qLevel);if(qCatType)setCategoryTypeFilter(qCatType);if(qCategoryLegacy){const val=qCategoryLegacy.toUpperCase();if(['A1','A2','B1','B2'].includes(val))setFilter(val);else if(['ERASMUS','HAZIRLIK','GENEL','GENEL Ä°NGÄ°LÄ°ZCE','GENEL INGILIZCE'].includes(val))setCategoryTypeFilter(qCategoryLegacy);}fetch('http://localhost:4000/api/history',{headers:token?{'Authorization':`Bearer ${token}`}:{}}).then(res=>res.json()).then(data=>{const list=data.history||[];setAllHistory(list);applyFilters(list);setLoading(false);}).catch(()=>{setAllHistory([]);setHistory([]);setLoading(false);});// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);// Re-apply filters when controls change or data changes\nuseEffect(()=>{applyFilters(allHistory);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[filter,sort,categoryTypeFilter,allHistory]);if(loading){return/*#__PURE__*/_jsx(Box,{sx:{minHeight:'100vh',bgcolor:palette.bg,display:'flex',alignItems:'center',justifyContent:'center',px:2},children:/*#__PURE__*/_jsx(Typography,{fontSize:22,children:\"Y\\xFCkleniyor...\"})});}if(allHistory.length===0){return/*#__PURE__*/_jsxs(Box,{sx:{minHeight:'100vh',bgcolor:palette.bg,display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',px:2},children:[/*#__PURE__*/_jsx(\"img\",{src:\"/empty-history.svg\",alt:\"\",style:{width:180,marginBottom:24}}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",color:palette.accent,fontWeight:700,children:\"Hen\\xFCz test \\xE7\\xF6zmediniz!\"}),/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",mt:1,children:\"\\xC7\\xF6zd\\xFC\\u011F\\xFCn\\xFCz s\\u0131navlar burada listelenecek.\"})]});}return/*#__PURE__*/_jsx(Box,{sx:{minHeight:'100vh',bgcolor:palette.bg,pt:0,pb:{xs:12,md:16},px:{xs:1,md:4},display:'flex',flexDirection:'column'},children:/*#__PURE__*/_jsxs(Paper,{elevation:6,sx:{width:'100%',maxWidth:1300,mx:'auto',p:0,mt:{xs:1,md:'15px'},borderRadius:4,background:'linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%)',backdropFilter:'blur(10px)',border:'1px solid rgba(255, 255, 255, 0.2)',boxShadow:'0 20px 40px rgba(0, 0, 0, 0.1)'},children:[/*#__PURE__*/_jsx(Box,{sx:{background:'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',color:'#fff',p:{xs:3,md:5},borderTopLeftRadius:'inherit',borderTopRightRadius:'inherit',borderBottomLeftRadius:0,borderBottomRightRadius:0,textAlign:'center',position:'relative',overflow:'hidden','&::before':{content:'\"\"',position:'absolute',inset:0,background:'rgba(255,255,255,0.08)',backdropFilter:'blur(4px)'}},children:/*#__PURE__*/_jsxs(Box,{sx:{position:'relative'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",fontWeight:800,mb:1,sx:{color:'#fff'},children:\"Ge\\xE7mi\\u015F Testleriniz\"}),/*#__PURE__*/_jsx(Typography,{sx:{opacity:0.95,color:'#fff'},children:\"Daha \\xF6nce \\xE7\\xF6zd\\xFC\\u011F\\xFCn\\xFCz testlerin detaylar\\u0131n\\u0131 burada g\\xF6rebilirsiniz.\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2,justifyContent:'center',mt:2,flexWrap:'wrap'},children:[/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",sx:{minWidth:120},children:[/*#__PURE__*/_jsx(InputLabel,{sx:{color:'rgba(255, 255, 255, 0.9)','&.Mui-focused':{color:'rgba(255, 255, 255, 0.9)'}},children:\"Seviye\"}),/*#__PURE__*/_jsxs(Select,{value:filter,onChange:e=>setFilter(e.target.value),label:\"Seviye\",sx:{color:'#fff','& .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255, 255, 255, 0.5)'},'&:hover .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255, 255, 255, 0.8)'},'&.Mui-focused .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255, 255, 255, 0.9)'},'& .MuiSvgIcon-root':{color:'rgba(255, 255, 255, 0.9)'}},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"all\",children:\"T\\xFCm Kategoriler\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"A1\",children:\"A1\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"A2\",children:\"A2\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"B1\",children:\"B1\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"B2\",children:\"B2\"})]})]}),/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",sx:{minWidth:180},children:[/*#__PURE__*/_jsx(InputLabel,{sx:{color:'rgba(255, 255, 255, 0.9)','&.Mui-focused':{color:'rgba(255, 255, 255, 0.9)'}},children:\"Kategori\"}),/*#__PURE__*/_jsxs(Select,{value:categoryTypeFilter,onChange:e=>setCategoryTypeFilter(e.target.value),label:\"Kategori\",sx:{color:'#fff','& .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255, 255, 255, 0.5)'},'&:hover .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255, 255, 255, 0.8)'},'&.Mui-focused .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255, 255, 255, 0.9)'},'& .MuiSvgIcon-root':{color:'rgba(255, 255, 255, 0.9)'}},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"all\",children:\"T\\xFCm\\xFC\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Erasmus\",children:\"Erasmus\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Haz\\u0131rl\\u0131k\",children:\"Haz\\u0131rl\\u0131k\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Genel \\u0130ngilizce\",children:\"Genel \\u0130ngilizce\"})]})]}),/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",sx:{minWidth:160},children:[/*#__PURE__*/_jsx(InputLabel,{sx:{color:'rgba(255, 255, 255, 0.9)','&.Mui-focused':{color:'rgba(255, 255, 255, 0.9)'}},children:\"S\\u0131ralama\"}),/*#__PURE__*/_jsxs(Select,{value:sort,onChange:e=>setSort(e.target.value),label:\"S\\u0131ralama\",sx:{color:'#fff','& .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255, 255, 255, 0.5)'},'&:hover .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255, 255, 255, 0.8)'},'&.Mui-focused .MuiOutlinedInput-notchedOutline':{borderColor:'rgba(255, 255, 255, 0.9)'},'& .MuiSvgIcon-root':{color:'rgba(255, 255, 255, 0.9)'}},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"desc\",children:\"En Yeni\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"asc\",children:\"En Eski\"})]})]})]})]})}),/*#__PURE__*/_jsxs(Box,{sx:{p:{xs:2,sm:4,md:5}},children:[history.length===0&&/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center',py:6},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:palette.accent,fontWeight:700,children:\"Bu filtrelere uygun kay\\u0131t bulunamad\\u0131.\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",sx:{mt:2},onClick:()=>{setFilter('all');setCategoryTypeFilter('all');},children:\"Filtreleri Temizle\"})]}),/*#__PURE__*/_jsx(Box,{sx:{width:'100%',maxWidth:1280,margin:'0 auto',display:'grid',gridTemplateColumns:{xs:'1fr',sm:'1fr 1fr',md:'1fr 1fr 1fr'},gap:'15px'},children:history.map((exam,idx)=>{var _ref2,_exam$correct,_ref3,_exam$incorrect;return/*#__PURE__*/_jsxs(Paper,{elevation:4,sx:{width:'100%',maxWidth:400,minWidth:260,p:3,borderRadius:3,mb:2,transition:'transform 0.2s ease, box-shadow 0.2s ease',cursor:'pointer',boxShadow:expanded===`card-${idx}`?'0 12px 30px rgba(0,0,0,0.12)':'0 6px 20px rgba(0,0,0,0.08)','&:hover':{transform:'translateY(-3px)',boxShadow:'0 12px 30px rgba(0,0,0,0.12)'},background:'rgba(255, 255, 255, 0.9)',border:'1px solid rgba(0, 184, 148, 0.2)',alignSelf:'start',minHeight:180,position:'relative'},children:[(()=>{// Colored number badge at top-right (single badge)\nconst lvl=(exam.title||exam.examTitle||'').toString().toUpperCase().match(/\\b(A1|A2|B1|B2)\\b/);const levelIndex=lvl?['A1','A2','B1','B2'].indexOf(lvl[1])+1:1;// Normalize difficulty and add robust fallbacks\nconst totalAns=Number(exam.correct||0)+Number(exam.incorrect||0)||0;const ratio=totalAns>0?Number(exam.correct||0)/totalAns:null;let diffRaw=(exam.difficultyOverall||exam.difficulty||'').toString().toLowerCase();if(!diffRaw){if(ratio==null)diffRaw='orta';else if(ratio>=0.75)diffRaw='kolay';else if(ratio<=0.4)diffRaw='zor';else diffRaw='orta';}// Map: kolay/Ã§ok kolay -> yellow, orta -> blue, zor/Ã§ok zor -> red\nlet bg='#90caf9';// default blue for orta\nlet fg='#0d47a1';if(diffRaw.includes('kolay')){bg='#ffd54f';fg='#5d4037';}if(diffRaw.includes('zor')){bg='#ef5350';fg='#fff';}const titleTxt=`Zorluk: ${diffRaw}`;return/*#__PURE__*/_jsx(Tooltip,{title:titleTxt,placement:\"left\",children:/*#__PURE__*/_jsx(Box,{sx:{position:'absolute',top:8,right:8,width:36,height:36,borderRadius:'50%',bgcolor:bg,color:fg,display:'flex',alignItems:'center',justifyContent:'center',fontWeight:800,boxShadow:'0 2px 8px rgba(0,0,0,0.18)',border:'2px solid #fff',zIndex:2},children:levelIndex})});})(),(()=>{/* no render here; used only to keep types happy in JSX scope */return null;})(),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'flex-start',alignItems:'center',mb:1},children:/*#__PURE__*/_jsx(Typography,{fontWeight:700,fontSize:18,children:exam.title||exam.examTitle})}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mb:1,width:'100%',pr:6},children:[/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",fontSize:15,sx:{flex:1},children:(()=>{let dateObj=null;if(exam.date)dateObj=new Date(exam.date);else if(exam.completedAt)dateObj=new Date(exam.completedAt);if(dateObj){const dateStr=dateObj.toLocaleDateString('tr-TR');const timeStr=dateObj.toLocaleTimeString('tr-TR',{hour:'2-digit',minute:'2-digit',hour12:false});return`ðŸ“… ${dateStr} - ${timeStr}`;}return'';})()}),/*#__PURE__*/_jsx(Box,{sx:{minWidth:90,display:'flex',justifyContent:'flex-end',position:'relative',zIndex:0},children:/*#__PURE__*/_jsx(Chip,{label:(()=>{const duration=exam.duration||exam.totalDuration;if(!duration)return'â± -';if(typeof duration==='string'&&isNaN(Number(duration))){return`â± ${duration}`;}if(!isNaN(Number(duration))){const min=Math.floor(Number(duration)/60);const sec=Number(duration)%60;return`â± ${min} dk${sec>0?' '+sec+' sn':''}`;}return`â± ${duration}`;})(),sx:{bgcolor:'#e3eafc',color:'#19376D',fontWeight:700,fontSize:15},size:\"small\"})})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2,mb:1},children:[/*#__PURE__*/_jsx(Chip,{label:`âœ… ${(_ref2=(_exam$correct=exam.correct)!==null&&_exam$correct!==void 0?_exam$correct:exam.totalCorrectAnswers)!==null&&_ref2!==void 0?_ref2:0}`,sx:{bgcolor:palette.correct,color:'#fff'}}),/*#__PURE__*/_jsx(Chip,{label:`âŒ ${(_ref3=(_exam$incorrect=exam.incorrect)!==null&&_exam$incorrect!==void 0?_exam$incorrect:exam.totalIncorrectAnswers)!==null&&_ref3!==void 0?_ref3:0}`,sx:{bgcolor:palette.wrong,color:'#fff'}})]}),(()=>{const hasDetails=exam.questions&&exam.questions.length>0||exam.answers&&exam.answers.length>0;return/*#__PURE__*/_jsx(Button,{variant:\"outlined\",size:\"small\",sx:{mt:1,borderRadius:2,fontWeight:700},disabled:!hasDetails,onClick:()=>{if(!hasDetails)return;setExpanded(expanded===`card-${idx}`?null:`card-${idx}`);},children:!hasDetails?'Detay Yok':expanded===`card-${idx}`?'DetayÄ± Gizle':'DetaylarÄ± GÃ¶r'});})(),/*#__PURE__*/_jsx(Collapse,{in:expanded===`card-${idx}`,children:/*#__PURE__*/_jsxs(Box,{mt:2,children:[(()=>{const hasDetails=exam.questions&&exam.questions.length>0||exam.answers&&exam.answers.length>0;if(!hasDetails){return/*#__PURE__*/_jsx(Typography,{mt:1,color:\"text.secondary\",fontSize:13,children:\"Bu test i\\xE7in soru bazl\\u0131 detay kayd\\u0131 bulunmuyor (eski kay\\u0131t).\"});}return null;})(),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',flexWrap:'wrap',gap:1,mb:2},children:(exam.questions||exam.answers||[]).map((q,i)=>/*#__PURE__*/_jsx(Box,{sx:{width:36,height:36,borderRadius:'50%',bgcolor:q.isCorrect?palette.correct:palette.wrong,color:'#fff',display:'flex',alignItems:'center',justifyContent:'center',fontWeight:700,fontSize:18,cursor:'pointer',border:'2px solid #fff',boxShadow:'0 1px 4px #0001',transition:'transform 0.1s','&:hover':{transform:'scale(1.12)'}},onClick:e=>{e.stopPropagation();setQuestionDialog({open:true,question:q,idx,qIdx:i});},children:i+1},i))}),/*#__PURE__*/_jsxs(Dialog,{open:!!questionDialog&&questionDialog.open&&questionDialog.idx===idx,onClose:()=>setQuestionDialog(null),maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsxs(DialogTitle,{sx:{display:'flex',alignItems:'center',justifyContent:'space-between',pr:1},children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Soru \",(questionDialog===null||questionDialog===void 0?void 0:questionDialog.qIdx)!==undefined?questionDialog.qIdx+1:'']}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>setQuestionDialog(null),size:\"small\",children:/*#__PURE__*/_jsx(CloseIcon,{})})]}),/*#__PURE__*/_jsxs(DialogContent,{children:[(questionDialog===null||questionDialog===void 0?void 0:questionDialog.question)&&/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:2,mb:2},children:[questionDialog.question.isCorrect?/*#__PURE__*/_jsx(CheckCircleIcon,{sx:{color:palette.correct}}):/*#__PURE__*/_jsx(CancelIcon,{sx:{color:palette.wrong}}),/*#__PURE__*/_jsx(Typography,{fontWeight:600,children:questionDialog.question.text||questionDialog.question.questionText})]}),(questionDialog===null||questionDialog===void 0?void 0:questionDialog.question)&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Typography,{fontSize:15,color:questionDialog.question.isCorrect?palette.correct:palette.wrong,mb:1,children:[\"Senin cevab\\u0131n: \",questionDialog.question.userAnswer,\" \",questionDialog.question.isCorrect?'(DoÄŸru)':'(YanlÄ±ÅŸ)']}),!questionDialog.question.isCorrect&&/*#__PURE__*/_jsxs(Typography,{fontSize:15,color:palette.accent,mb:1,children:[\"Do\\u011Fru cevap: \",questionDialog.question.correctAnswer]}),questionDialog.question.explanation&&/*#__PURE__*/_jsxs(Box,{mt:2,children:[/*#__PURE__*/_jsx(Typography,{fontWeight:700,fontSize:15,color:palette.accent,mb:0.5,children:\"A\\xE7\\u0131klama\"}),/*#__PURE__*/_jsx(Typography,{fontSize:15,color:\"text.secondary\",children:questionDialog.question.explanation})]})]})]})]})]})})]},exam.id);})})]})]})});};export default History;","map":{"version":3,"names":["React","useEffect","useState","useLocation","Box","Paper","Typography","Button","Collapse","Chip","Select","MenuItem","Dialog","DialogTitle","DialogContent","IconButton","FormControl","InputLabel","Tooltip","CloseIcon","CheckCircleIcon","CancelIcon","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","palette","bg","card","accent","correct","wrong","gray","History","_ref","token","window","localStorage","getItem","location","href","history","setHistory","allHistory","setAllHistory","expanded","setExpanded","questionDialog","setQuestionDialog","loading","setLoading","filter","setFilter","sort","setSort","categoryTypeFilter","setCategoryTypeFilter","getExamCategoryType","exam","title","examTitle","toString","toLowerCase","catName","categoryName","category","s","includes","matchCategory","value","toUpperCase","cat","level","getDateValue","d","date","completedAt","createdAt","dt","Date","getTime","applyFilters","source","list","want","a","b","reverse","params","URLSearchParams","search","qCategoryLegacy","get","qLevel","qCatType","val","fetch","headers","then","res","json","data","catch","sx","minHeight","bgcolor","display","alignItems","justifyContent","px","children","fontSize","length","flexDirection","src","alt","style","width","marginBottom","variant","color","fontWeight","mt","pt","pb","xs","md","elevation","maxWidth","mx","p","borderRadius","background","backdropFilter","border","boxShadow","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","textAlign","position","overflow","content","inset","mb","opacity","gap","flexWrap","minWidth","onChange","e","target","label","borderColor","sm","py","onClick","margin","gridTemplateColumns","map","idx","_ref2","_exam$correct","_ref3","_exam$incorrect","transition","cursor","transform","alignSelf","lvl","match","levelIndex","indexOf","totalAns","Number","incorrect","ratio","diffRaw","difficultyOverall","difficulty","fg","titleTxt","placement","top","right","height","zIndex","pr","flex","dateObj","dateStr","toLocaleDateString","timeStr","toLocaleTimeString","hour","minute","hour12","duration","totalDuration","isNaN","min","Math","floor","sec","size","totalCorrectAnswers","totalIncorrectAnswers","hasDetails","questions","answers","disabled","in","q","i","isCorrect","stopPropagation","open","question","qIdx","onClose","fullWidth","undefined","text","questionText","userAnswer","correctAnswer","explanation","id"],"sources":["/Users/yavuz/Desktop/portfolio/erasmus-exam-page/frontend/src/pages/History.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { Box, Paper, Typography, Button, Collapse, Chip, Select, MenuItem, Dialog, DialogTitle, DialogContent, IconButton, FormControl, InputLabel, Tooltip } from '@mui/material';\nimport CloseIcon from '@mui/icons-material/Close';\nimport CheckCircleIcon from '@mui/icons-material/CheckCircle';\nimport CancelIcon from '@mui/icons-material/Cancel';\n\nconst palette = {\n  bg: '#b2dfdb',\n  card: '#fff',\n  accent: '#1976d2',\n  correct: '#43a047',\n  wrong: '#e53935',\n  gray: '#e3eafc',\n};\n\n\ninterface HistoryProps {\n  token: string;\n}\n\nconst History: React.FC<HistoryProps> = ({ token }) => {\n  // Redirect in effect to keep hooks order intact\n  useEffect(() => {\n    if (typeof window !== 'undefined' && (!token || !localStorage.getItem('token'))) {\n      window.location.href = '/login?session=expired';\n    }\n  }, [token]);\n  const [history, setHistory] = useState<any[]>([]);\n  const [allHistory, setAllHistory] = useState<any[]>([]);\n  const [expanded, setExpanded] = useState<string | null>(null);\n  const [questionDialog, setQuestionDialog] = useState<{ open: boolean, question: any, idx: number, qIdx: number } | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [filter, setFilter] = useState('all');\n  const [sort, setSort] = useState('desc');\n  const [categoryTypeFilter, setCategoryTypeFilter] = useState('all');\n  const location = useLocation();\n\n  // Helpers\n  function getExamCategoryType(exam: any): 'ERASMUS' | 'GENEL' | 'HAZIRLIK' | null {\n    const title = (exam.title || exam.examTitle || '').toString().toLowerCase();\n    const catName = (exam.categoryName || exam.category || '').toString().toLowerCase();\n    const s = `${title} ${catName}`;\n    if (s.includes('erasmus')) return 'ERASMUS';\n    if (s.includes('genel') || s.includes('general')) return 'GENEL';\n    if (s.includes('hazÄ±rlÄ±k') || s.includes('hazirlik')) return 'HAZIRLIK';\n    return null;\n  }\n\n  function matchCategory(exam: any, value: string) {\n    if (value === 'all') return true;\n    const title = (exam.title || exam.examTitle || '').toString().toUpperCase();\n    const cat = (exam.category || exam.categoryName || exam.level || '').toString().toUpperCase();\n    return title.includes(value.toUpperCase()) || cat === value.toUpperCase();\n  }\n\n  function getDateValue(exam: any): number {\n    const d = exam.date || exam.completedAt || exam.createdAt;\n    const dt = d ? new Date(d) : null;\n    return dt ? dt.getTime() : 0;\n  }\n\n  function applyFilters(source: any[]) {\n    let list = source;\n    // Level (A1/A2/B1/B2)\n    if (filter !== 'all') list = list.filter((exam) => matchCategory(exam, filter));\n    // Category type (Erasmus/Genel/HazÄ±rlÄ±k)\n    if (categoryTypeFilter !== 'all') {\n      const want = categoryTypeFilter.toUpperCase();\n      list = list.filter((exam) => getExamCategoryType(exam) === (want === 'GENEL Ä°NGÄ°LÄ°ZCE' ? 'GENEL' : (want as any)));\n    }\n    // Sort by date\n    list = [...list].sort((a, b) => getDateValue(b) - getDateValue(a));\n    if (sort === 'asc') list.reverse();\n    setHistory(list);\n  }\n\n  // Initial load + parse URL filters\n  useEffect(() => {\n    if (!token) return; // defensive: avoid fetching without token\n    setLoading(true);\n    const params = new URLSearchParams(location.search);\n    const qCategoryLegacy = params.get('category');\n    const qLevel = params.get('level');\n    const qCatType = params.get('cat');\n    // Backward compat: category=A1|A2.. used as level; if it's a known type, map accordingly\n    if (qLevel) setFilter(qLevel);\n    if (qCatType) setCategoryTypeFilter(qCatType);\n    if (qCategoryLegacy) {\n      const val = qCategoryLegacy.toUpperCase();\n      if (['A1', 'A2', 'B1', 'B2'].includes(val)) setFilter(val);\n      else if (['ERASMUS', 'HAZIRLIK', 'GENEL', 'GENEL Ä°NGÄ°LÄ°ZCE', 'GENEL INGILIZCE'].includes(val)) setCategoryTypeFilter(qCategoryLegacy);\n    }\n    fetch('http://localhost:4000/api/history', { headers: token ? { 'Authorization': `Bearer ${token}` } : {} })\n      .then(res => res.json())\n      .then(data => {\n        const list = data.history || [];\n        setAllHistory(list);\n        applyFilters(list);\n        setLoading(false);\n      })\n      .catch(() => {\n        setAllHistory([]);\n        setHistory([]);\n        setLoading(false);\n      });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Re-apply filters when controls change or data changes\n  useEffect(() => {\n    applyFilters(allHistory);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [filter, sort, categoryTypeFilter, allHistory]);\n\n  if (loading) {\n    return (\n      <Box \n        sx={{ \n          minHeight: '100vh', \n          bgcolor: palette.bg, \n          display: 'flex', \n          alignItems: 'center', \n          justifyContent: 'center', \n          px: 2 \n        }}\n      >\n        <Typography fontSize={22}>YÃ¼kleniyor...</Typography>\n      </Box>\n    );\n  }\n\n  if (allHistory.length === 0) {\n    return (\n      <Box \n        sx={{ \n          minHeight: '100vh', \n          bgcolor: palette.bg, \n          display: 'flex', \n          flexDirection: 'column', \n          alignItems: 'center', \n          justifyContent: 'center', \n          px: 2 \n        }}\n      >\n        <img src=\"/empty-history.svg\" alt=\"\" style={{ width: 180, marginBottom: 24 }} />\n        <Typography variant=\"h5\" color={palette.accent} fontWeight={700}>HenÃ¼z test Ã§Ã¶zmediniz!</Typography>\n        <Typography color=\"text.secondary\" mt={1}>Ã‡Ã¶zdÃ¼ÄŸÃ¼nÃ¼z sÄ±navlar burada listelenecek.</Typography>\n      </Box>\n    );\n  }\n\n  return (\n    <Box sx={{ minHeight: '100vh', bgcolor: palette.bg, pt: 0, pb: { xs: 12, md: 16 }, px: { xs: 1, md: 4 }, display: 'flex', flexDirection: 'column' }}>\n      <Paper \n        elevation={6} \n        sx={{ \n          width: '100%', \n          maxWidth: 1300, \n          mx: 'auto', \n          p: 0,\n          mt: { xs: 1, md: '15px' },\n          borderRadius: 4,\n          background: 'linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%)',\n          backdropFilter: 'blur(10px)',\n          border: '1px solid rgba(255, 255, 255, 0.2)',\n          boxShadow: '0 20px 40px rgba(0, 0, 0, 0.1)'\n        }}\n      >\n        {/* Merged gradient header like other pages */}\n        <Box sx={{\n          background: 'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',\n          color: '#fff',\n          p: { xs: 3, md: 5 },\n          borderTopLeftRadius: 'inherit',\n          borderTopRightRadius: 'inherit',\n          borderBottomLeftRadius: 0,\n          borderBottomRightRadius: 0,\n          textAlign: 'center',\n          position: 'relative',\n          overflow: 'hidden',\n          '&::before': {\n            content: '\"\"',\n            position: 'absolute',\n            inset: 0,\n            background: 'rgba(255,255,255,0.08)',\n            backdropFilter: 'blur(4px)'\n          }\n        }}>\n          <Box sx={{ position: 'relative' }}>\n            <Typography variant=\"h4\" fontWeight={800} mb={1} sx={{ color: '#fff' }}>GeÃ§miÅŸ Testleriniz</Typography>\n            <Typography sx={{ opacity: 0.95, color: '#fff' }}>Daha Ã¶nce Ã§Ã¶zdÃ¼ÄŸÃ¼nÃ¼z testlerin detaylarÄ±nÄ± burada gÃ¶rebilirsiniz.</Typography>\n            {/* Filters in header, styled like Rankings */}\n            <Box sx={{ display: 'flex', gap: 2, justifyContent: 'center', mt: 2, flexWrap: 'wrap' }}>\n              <FormControl variant=\"outlined\" sx={{ minWidth: 120 }}>\n                <InputLabel sx={{ color: 'rgba(255, 255, 255, 0.9)', '&.Mui-focused': { color: 'rgba(255, 255, 255, 0.9)' } }}>Seviye</InputLabel>\n                <Select\n                  value={filter}\n                  onChange={(e) => setFilter(e.target.value)}\n                  label=\"Seviye\"\n                  sx={{ color: '#fff', '& .MuiOutlinedInput-notchedOutline': { borderColor: 'rgba(255, 255, 255, 0.5)' }, '&:hover .MuiOutlinedInput-notchedOutline': { borderColor: 'rgba(255, 255, 255, 0.8)' }, '&.Mui-focused .MuiOutlinedInput-notchedOutline': { borderColor: 'rgba(255, 255, 255, 0.9)' }, '& .MuiSvgIcon-root': { color: 'rgba(255, 255, 255, 0.9)' } }}\n                >\n                  <MenuItem value=\"all\">TÃ¼m Kategoriler</MenuItem>\n                  <MenuItem value=\"A1\">A1</MenuItem>\n                  <MenuItem value=\"A2\">A2</MenuItem>\n                  <MenuItem value=\"B1\">B1</MenuItem>\n                  <MenuItem value=\"B2\">B2</MenuItem>\n                </Select>\n              </FormControl>\n              <FormControl variant=\"outlined\" sx={{ minWidth: 180 }}>\n                <InputLabel sx={{ color: 'rgba(255, 255, 255, 0.9)', '&.Mui-focused': { color: 'rgba(255, 255, 255, 0.9)' } }}>Kategori</InputLabel>\n                <Select\n                  value={categoryTypeFilter}\n                  onChange={(e) => setCategoryTypeFilter(e.target.value)}\n                  label=\"Kategori\"\n                  sx={{ color: '#fff', '& .MuiOutlinedInput-notchedOutline': { borderColor: 'rgba(255, 255, 255, 0.5)' }, '&:hover .MuiOutlinedInput-notchedOutline': { borderColor: 'rgba(255, 255, 255, 0.8)' }, '&.Mui-focused .MuiOutlinedInput-notchedOutline': { borderColor: 'rgba(255, 255, 255, 0.9)' }, '& .MuiSvgIcon-root': { color: 'rgba(255, 255, 255, 0.9)' } }}\n                >\n                  <MenuItem value=\"all\">TÃ¼mÃ¼</MenuItem>\n                  <MenuItem value=\"Erasmus\">Erasmus</MenuItem>\n                  <MenuItem value=\"HazÄ±rlÄ±k\">HazÄ±rlÄ±k</MenuItem>\n                  <MenuItem value=\"Genel Ä°ngilizce\">Genel Ä°ngilizce</MenuItem>\n                </Select>\n              </FormControl>\n              <FormControl variant=\"outlined\" sx={{ minWidth: 160 }}>\n                <InputLabel sx={{ color: 'rgba(255, 255, 255, 0.9)', '&.Mui-focused': { color: 'rgba(255, 255, 255, 0.9)' } }}>SÄ±ralama</InputLabel>\n                <Select\n                  value={sort}\n                  onChange={(e) => setSort(e.target.value)}\n                  label=\"SÄ±ralama\"\n                  sx={{ color: '#fff', '& .MuiOutlinedInput-notchedOutline': { borderColor: 'rgba(255, 255, 255, 0.5)' }, '&:hover .MuiOutlinedInput-notchedOutline': { borderColor: 'rgba(255, 255, 255, 0.8)' }, '&.Mui-focused .MuiOutlinedInput-notchedOutline': { borderColor: 'rgba(255, 255, 255, 0.9)' }, '& .MuiSvgIcon-root': { color: 'rgba(255, 255, 255, 0.9)' } }}\n                >\n                  <MenuItem value=\"desc\">En Yeni</MenuItem>\n                  <MenuItem value=\"asc\">En Eski</MenuItem>\n                </Select>\n              </FormControl>\n            </Box>\n          </Box>\n        </Box>\n\n        {/* Content wrapper */}\n        <Box sx={{ p: { xs: 2, sm: 4, md: 5 } }}>\n          {/* No results for current filters */}\n          {history.length === 0 && (\n            <Box sx={{ textAlign: 'center', py: 6 }}>\n              <Typography variant=\"h6\" color={palette.accent} fontWeight={700}>Bu filtrelere uygun kayÄ±t bulunamadÄ±.</Typography>\n              <Button variant=\"outlined\" sx={{ mt: 2 }} onClick={() => { setFilter('all'); setCategoryTypeFilter('all'); }}>\n                Filtreleri Temizle\n              </Button>\n            </Box>\n          )}\n\n          {/* Cards grid */}\n          <Box\n            sx={{\n              width: '100%',\n              maxWidth: 1280,\n              margin: '0 auto',\n              display: 'grid',\n              gridTemplateColumns: { xs: '1fr', sm: '1fr 1fr', md: '1fr 1fr 1fr' },\n              gap: '15px',\n            }}\n          >\n            {history.map((exam, idx) => (\n        <Paper\n                key={exam.id}\n                elevation={4}\n                sx={{\n                  width: '100%',\n                  maxWidth: 400,\n                  minWidth: 260,\n          p: 3,\n                  borderRadius: 3,\n                  mb: 2,\n                  transition: 'transform 0.2s ease, box-shadow 0.2s ease',\n                  cursor: 'pointer',\n                  boxShadow: expanded === `card-${idx}` ? '0 12px 30px rgba(0,0,0,0.12)' : '0 6px 20px rgba(0,0,0,0.08)',\n                  '&:hover': { transform: 'translateY(-3px)', boxShadow: '0 12px 30px rgba(0,0,0,0.12)' },\n                  background: 'rgba(255, 255, 255, 0.9)',\n                  border: '1px solid rgba(0, 184, 148, 0.2)',\n          alignSelf: 'start',\n          minHeight: 180,\n          position: 'relative',\n                }}\n              >\n              {(() => {\n                // Colored number badge at top-right (single badge)\n                const lvl = (exam.title || exam.examTitle || '').toString().toUpperCase().match(/\\b(A1|A2|B1|B2)\\b/);\n                const levelIndex = lvl ? (['A1','A2','B1','B2'].indexOf(lvl[1]) + 1) : 1;\n                // Normalize difficulty and add robust fallbacks\n                const totalAns = (Number(exam.correct || 0) + Number(exam.incorrect || 0)) || 0;\n                const ratio = totalAns > 0 ? Number(exam.correct || 0) / totalAns : null;\n                let diffRaw = (exam.difficultyOverall || (exam.difficulty || '')).toString().toLowerCase();\n                if (!diffRaw) {\n                  if (ratio == null) diffRaw = 'orta';\n                  else if (ratio >= 0.75) diffRaw = 'kolay';\n                  else if (ratio <= 0.4) diffRaw = 'zor';\n                  else diffRaw = 'orta';\n                }\n                // Map: kolay/Ã§ok kolay -> yellow, orta -> blue, zor/Ã§ok zor -> red\n                let bg = '#90caf9'; // default blue for orta\n                let fg = '#0d47a1';\n                if (diffRaw.includes('kolay')) { bg = '#ffd54f'; fg = '#5d4037'; }\n                if (diffRaw.includes('zor')) { bg = '#ef5350'; fg = '#fff'; }\n                const titleTxt = `Zorluk: ${diffRaw}`;\n                return (\n                  <Tooltip title={titleTxt} placement=\"left\">\n                    <Box sx={{ position: 'absolute', top: 8, right: 8, width: 36, height: 36, borderRadius: '50%', bgcolor: bg, color: fg, display: 'flex', alignItems: 'center', justifyContent: 'center', fontWeight: 800, boxShadow: '0 2px 8px rgba(0,0,0,0.18)', border: '2px solid #fff', zIndex: 2 }}>\n                      {levelIndex}\n                    </Box>\n                  </Tooltip>\n                );\n              })()}\n              {/** Some older records may not have per-question answers saved. */}\n              {/** Detect if this record actually has question details we can show. */}\n              {(() => {\n                /* no render here; used only to keep types happy in JSX scope */\n                return null;\n              })()}\n              <Box sx={{ display: 'flex', justifyContent: 'flex-start', alignItems: 'center', mb: 1 }}>\n                <Typography fontWeight={700} fontSize={18}>{exam.title || exam.examTitle}</Typography>\n              </Box>\n              <Box sx={{ display: 'flex', alignItems: 'center', mb: 1, width: '100%', pr: 6 }}>\n                <Typography color=\"text.secondary\" fontSize={15} sx={{ flex: 1 }}>\n                  {(() => {\n                    let dateObj = null;\n                    if (exam.date) dateObj = new Date(exam.date);\n                    else if (exam.completedAt) dateObj = new Date(exam.completedAt);\n                    if (dateObj) {\n                      const dateStr = dateObj.toLocaleDateString('tr-TR');\n                      const timeStr = dateObj.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit', hour12: false });\n                      return `ðŸ“… ${dateStr} - ${timeStr}`;\n                    }\n                    return '';\n                  })()}\n                </Typography>\n                <Box sx={{ minWidth: 90, display: 'flex', justifyContent: 'flex-end', position: 'relative', zIndex: 0 }}>\n                  <Chip\n                    label={(() => {\n                      const duration = exam.duration || exam.totalDuration;\n                      if (!duration) return 'â± -';\n                      if (typeof duration === 'string' && isNaN(Number(duration))) {\n                        return `â± ${duration}`;\n                      }\n                      if (!isNaN(Number(duration))) {\n                        const min = Math.floor(Number(duration) / 60);\n                        const sec = Number(duration) % 60;\n                        return `â± ${min} dk${sec > 0 ? ' ' + sec + ' sn' : ''}`;\n                      }\n                      return `â± ${duration}`;\n                    })()}\n                    sx={{ bgcolor: '#e3eafc', color: '#19376D', fontWeight: 700, fontSize: 15 }}\n                    size=\"small\"\n                  />\n                </Box>\n              </Box>\n              <Box sx={{ display: 'flex', gap: 2, mb: 1 }}>\n                <Chip label={`âœ… ${exam.correct ?? exam.totalCorrectAnswers ?? 0}`} sx={{ bgcolor: palette.correct, color: '#fff' }} />\n                <Chip label={`âŒ ${exam.incorrect ?? exam.totalIncorrectAnswers ?? 0}`} sx={{ bgcolor: palette.wrong, color: '#fff' }} />\n              </Box>\n              {(() => {\n                const hasDetails = (exam.questions && exam.questions.length > 0) || (exam.answers && exam.answers.length > 0);\n                return (\n              <Button\n                variant=\"outlined\"\n                size=\"small\"\n                sx={{ mt: 1, borderRadius: 2, fontWeight: 700 }}\n                disabled={!hasDetails}\n                onClick={() => {\n                  if (!hasDetails) return;\n                  setExpanded(expanded === `card-${idx}` ? null : `card-${idx}`);\n                }}\n              >\n                {!hasDetails ? 'Detay Yok' : expanded === `card-${idx}` ? 'DetayÄ± Gizle' : 'DetaylarÄ± GÃ¶r'}\n              </Button>\n                );\n              })()}\n              {/* Removed extra message to keep card heights equal in collapsed view */}\n              <Collapse in={expanded === `card-${idx}`}> \n                <Box mt={2}>\n                  {(() => {\n                    const hasDetails = (exam.questions && exam.questions.length > 0) || (exam.answers && exam.answers.length > 0);\n                    if (!hasDetails) {\n                      return (\n                        <Typography mt={1} color=\"text.secondary\" fontSize={13}>\n                          Bu test iÃ§in soru bazlÄ± detay kaydÄ± bulunmuyor (eski kayÄ±t).\n                        </Typography>\n                      );\n                    }\n                    return null;\n                  })()}\n                  <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1, mb: 2 }}>\n                    {(exam.questions || exam.answers || []).map((q: any, i: number) => (\n                      <Box\n                        key={i}\n                        sx={{\n                          width: 36,\n                          height: 36,\n                          borderRadius: '50%',\n                          bgcolor: q.isCorrect ? palette.correct : palette.wrong,\n                          color: '#fff',\n                          display: 'flex',\n                          alignItems: 'center',\n                          justifyContent: 'center',\n                          fontWeight: 700,\n                          fontSize: 18,\n                          cursor: 'pointer',\n                          border: '2px solid #fff',\n                          boxShadow: '0 1px 4px #0001',\n                          transition: 'transform 0.1s',\n                          '&:hover': { transform: 'scale(1.12)' },\n                        }}\n                        onClick={e => {\n                          e.stopPropagation();\n                          setQuestionDialog({ open: true, question: q, idx, qIdx: i });\n                        }}\n                      >\n                        {i + 1}\n                      </Box>\n                    ))}\n                  </Box>\n                  <Dialog\n                    open={!!questionDialog && questionDialog.open && questionDialog.idx === idx}\n                    onClose={() => setQuestionDialog(null)}\n                    maxWidth=\"sm\"\n                    fullWidth\n                  >\n                    <DialogTitle sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', pr: 1 }}>\n                      <span>Soru {questionDialog?.qIdx !== undefined ? questionDialog.qIdx + 1 : ''}</span>\n                      <IconButton onClick={() => setQuestionDialog(null)} size=\"small\"><CloseIcon /></IconButton>\n                    </DialogTitle>\n                    <DialogContent>\n                      {questionDialog?.question && (\n                        <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, mb: 2 }}>\n                          {questionDialog.question.isCorrect\n                            ? <CheckCircleIcon sx={{ color: palette.correct }} />\n                            : <CancelIcon sx={{ color: palette.wrong }} />}\n                          <Typography fontWeight={600}>{questionDialog.question.text || questionDialog.question.questionText}</Typography>\n                        </Box>\n                      )}\n                      {questionDialog?.question && (\n                        <>\n                          <Typography fontSize={15} color={questionDialog.question.isCorrect ? palette.correct : palette.wrong} mb={1}>\n                            Senin cevabÄ±n: {questionDialog.question.userAnswer} {questionDialog.question.isCorrect ? '(DoÄŸru)' : '(YanlÄ±ÅŸ)'}\n                          </Typography>\n                          {!questionDialog.question.isCorrect && (\n                            <Typography fontSize={15} color={palette.accent} mb={1}>\n                              DoÄŸru cevap: {questionDialog.question.correctAnswer}\n                            </Typography>\n                          )}\n                          {questionDialog.question.explanation && (\n                            <Box mt={2}>\n                              <Typography fontWeight={700} fontSize={15} color={palette.accent} mb={0.5}>AÃ§Ä±klama</Typography>\n                              <Typography fontSize={15} color=\"text.secondary\">{questionDialog.question.explanation}</Typography>\n                            </Box>\n                          )}\n                        </>\n                      )}\n                    </DialogContent>\n                  </Dialog>\n                </Box>\n              </Collapse>\n            </Paper>\n          ))}\n        </Box>\n        {/* Close content wrapper */}\n        </Box>\n       </Paper>\n     </Box>\n   );\n }\n\nexport default History;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}