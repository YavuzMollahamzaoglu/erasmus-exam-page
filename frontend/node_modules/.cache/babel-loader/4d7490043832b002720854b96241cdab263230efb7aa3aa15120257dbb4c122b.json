{"ast":null,"code":"import React,{useEffect,useState,useRef}from'react';import{useParams,useLocation,useNavigate}from'react-router-dom';import{Box,Paper,Typography,Button,CircularProgress,IconButton}from'@mui/material';import ArrowBackIcon from'@mui/icons-material/ArrowBack';import ArrowForwardIcon from'@mui/icons-material/ArrowForward';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Exam=()=>{const{testId}=useParams();const location=useLocation();const navigate=useNavigate();const[questions,setQuestions]=useState([]);const[loading,setLoading]=useState(true);const[current,setCurrent]=useState(0);const[selected,setSelected]=useState(null);const[showResult,setShowResult]=useState(false);const[showExplanation,setShowExplanation]=useState(false);const[score,setScore]=useState(0);const[mistakes,setMistakes]=useState(0);const[showSummary,setShowSummary]=useState(false);const[time,setTime]=useState(0);const[reviewMode,setReviewMode]=useState(false);const[answers,setAnswers]=useState([]);const[timerPaused,setTimerPaused]=useState(false);const timerRef=useRef(null);const[error,setError]=useState(null);// Helper function to format text: first letter uppercase, rest lowercase\nconst formatText=text=>{if(!text||text.length===0)return text;return text.charAt(0).toUpperCase()+text.slice(1).toLowerCase();};// Helper function for case insensitive comparison\nconst compareAnswers=(answer1,answer2)=>{return answer1.toLowerCase()===answer2.toLowerCase();};useEffect(()=>{var _location$state;// Fetch if no state or empty state provided\nif(!((_location$state=location.state)!==null&&_location$state!==void 0&&_location$state.questions)||location.state.questions.length===0){setLoading(true);setError(null);// For dynamic tests, use the questions endpoint directly with filters\nconst API_URL=process.env.REACT_APP_API_URL||'http://localhost:4000';let apiUrl;if(testId==='dynamic'||testId!==null&&testId!==void 0&&testId.startsWith('dynamic-')){apiUrl=`${API_URL}/api/questions`;// Add category filter based on testId and lock series to Erasmus Sınavı\n// so Üniversite Hazırlık soruları dinamik Erasmus kartlarına karışmasın.\nconst params=new URLSearchParams();if(testId==='dynamic-a1'){params.set('category','A1');}else if(testId==='dynamic-a2'||testId==='dynamic'){params.set('category','A2');}else if(testId==='dynamic-b1'){params.set('category','B1');}else if(testId==='dynamic-b2'){params.set('category','B2');}// Restrict to Erasmus series explicitly\nparams.set('series','Erasmus Sınavı');apiUrl+=`?${params.toString()}`;}else{apiUrl=`${API_URL}/api/tests/${testId}/questions`;}console.log(`Fetching questions from: ${apiUrl}`);fetch(apiUrl).then(res=>{console.log('API Response status:',res.status);if(!res.ok){throw new Error(`Request failed with status ${res.status}`);}return res.json();}).then(data=>{console.log('API Response data:',data);const questionsData=data.questions||data||[];console.log('Questions data length:',questionsData.length);const formattedQuestions=questionsData.map(q=>{// Parse options if they're in string format\nlet optionsArray=[];if(Array.isArray(q.options)){optionsArray=q.options.map(formatText);}else if(typeof q.options==='string'){try{optionsArray=JSON.parse(q.options).map(formatText);}catch{optionsArray=[];}}// Convert correct answer to letter if it's a word\nlet correctLetter=q.correct;if(q.correct&&q.correct.length>1){// If correct is a word, find its index in options and convert to letter\nconst correctIndex=optionsArray.findIndex(option=>option.toLowerCase()===q.correct.toLowerCase());if(correctIndex!==-1){correctLetter=String.fromCharCode(65+correctIndex);// A, B, C, D\nconsole.log(`Converted \"${q.correct}\" to letter \"${correctLetter}\"`);}}return{...q,options:optionsArray,correct:correctLetter};});console.log(`Loaded ${formattedQuestions.length} questions`);setQuestions(formattedQuestions);setLoading(false);}).catch(error=>{console.error('Failed to fetch questions:',error);setError('Sunucuya ulaşılamıyor. Lütfen sunucuyu başlatıp tekrar deneyin.');setLoading(false);});}else{// Format questions from state as well\nconst formattedQuestions=location.state.questions.map(q=>{// Parse options if they're in string format\nlet optionsArray=[];if(Array.isArray(q.options)){optionsArray=q.options.map(formatText);}else if(typeof q.options==='string'){try{optionsArray=JSON.parse(q.options).map(formatText);}catch{optionsArray=[];}}// Convert correct answer to letter if it's a word\nlet correctLetter=q.correct;if(q.correct&&q.correct.length>1){// If correct is a word, find its index in options and convert to letter\nconst correctIndex=optionsArray.findIndex(option=>option.toLowerCase()===q.correct.toLowerCase());if(correctIndex!==-1){correctLetter=String.fromCharCode(65+correctIndex);// A, B, C, D\nconsole.log(`Converted \"${q.correct}\" to letter \"${correctLetter}\"`);}}return{...q,options:optionsArray,correct:correctLetter};});setQuestions(formattedQuestions);setLoading(false);}},[location.state,testId]);// Initialize answers array when questions are loaded\nuseEffect(()=>{if(questions.length>0&&answers.length!==questions.length){setAnswers(Array(questions.length).fill(null));}},[questions,answers.length]);// Timer logic - pause when answer is selected or exam is finished\nuseEffect(()=>{if(showSummary||timerPaused)return;timerRef.current=setInterval(()=>{setTime(t=>t+1);},1000);return()=>{if(timerRef.current)clearInterval(timerRef.current);};},[showSummary,timerPaused]);if(loading){return/*#__PURE__*/_jsx(Box,{sx:{minHeight:'100vh',bgcolor:'#b2ebf2',display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsxs(Box,{sx:{p:4,borderRadius:4,background:'linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)',boxShadow:'0 20px 40px rgba(0,0,0,0.1)',textAlign:'center'},children:[/*#__PURE__*/_jsx(CircularProgress,{sx:{color:'#00b894',mb:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{color:'#2c3e50',fontWeight:600},children:\"Sorular Y\\xFCkleniyor...\"})]})});}if(error){return/*#__PURE__*/_jsx(Box,{sx:{minHeight:'100vh',bgcolor:'#b2ebf2',display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsxs(Box,{sx:{p:4,borderRadius:4,background:'linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)',boxShadow:'0 20px 40px rgba(0,0,0,0.1)',textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{color:'#c62828',fontWeight:600,mb:2},children:error}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:()=>window.location.reload(),children:\"Tekrar Dene\"})]})});}if(!questions.length){return/*#__PURE__*/_jsx(Typography,{align:\"center\",mt:8,children:\"Bu s\\u0131nav i\\xE7in soru bulunamad\\u0131.\"});}const q=questions[current];// Ensure options is always an array\nlet options=[];if(Array.isArray(q.options)){options=q.options;}else if(typeof q.options==='string'){try{options=JSON.parse(q.options);}catch{options=[];}}// Helper function to get correct answer text\nconst getCorrectAnswerText=()=>{if(!q.correct||options.length===0)return q.correct;const correctIndex=q.correct.charCodeAt(0)-65;// A=0, B=1, C=2, D=3\nconst correctText=options[correctIndex];return correctText?`${q.correct}) ${correctText}`:q.correct;};const handleSelect=optionIndex=>{const selectedLetter=String.fromCharCode(65+optionIndex);// 0->A, 1->B, 2->C, 3->D\nconsole.log('Selected option index:',optionIndex);console.log('Selected letter:',selectedLetter);console.log('Question correct answer:',q.correct);console.log('Question correct answer type:',typeof q.correct);setSelected(selectedLetter);setShowResult(true);setTimerPaused(true);// Pause timer when answer is selected\nsetAnswers(prev=>{const copy=[...prev];copy[current]=selectedLetter;return copy;});if(compareAnswers(selectedLetter,q.correct)){setScore(s=>s+1);}else{setMistakes(m=>m+1);}};const nextQuestion=()=>{if(current<questions.length-1){setCurrent(c=>c+1);setSelected(answers[current+1]||null);setShowResult(!!answers[current+1]);setShowExplanation(false);setTimerPaused(false);// Resume timer when moving to next question\n}};// Sınavı history'ye kaydet (explicit payload to avoid stale state)\nconst saveToHistory=async payload=>{const token=localStorage.getItem('token');// Kullanıcı giriş yapmadıysa history kaydı denemeyelim; sessizce çık\nif(!token)return;try{var _questions$,_questions$2,_questions$3,_questions$4;const res=await fetch('http://localhost:4000/api/history',{method:'POST',headers:{'Content-Type':'application/json',...(token?{'Authorization':`Bearer ${token}`}:{})},body:JSON.stringify({category:typeof((_questions$=questions[0])===null||_questions$===void 0?void 0:_questions$.categoryId)==='string'?(_questions$2=questions[0])===null||_questions$2===void 0?void 0:_questions$2.categoryId:String((_questions$3=questions[0])===null||_questions$3===void 0?void 0:_questions$3.categoryId),seriesId:((_questions$4=questions[0])===null||_questions$4===void 0?void 0:_questions$4.seriesId)||null,duration:payload?payload.duration:time,correct:payload?payload.correct:score,incorrect:payload?payload.incorrect:mistakes,questions:questions.map((q,idx)=>({questionId:q.id,userAnswer:payload?payload.answersArray[idx]:answers[idx],isCorrect:(()=>{const ua=payload?payload.answersArray[idx]:answers[idx];return ua?compareAnswers(ua,q.correct):false;})()}))})});if(!res.ok){try{const data=await res.json();// eslint-disable-next-line no-console\nconsole.error('History save error:',data);}catch(e){// eslint-disable-next-line no-console\nconsole.error('History save error (no json):',res.status,res.statusText);}// Do not alert here; interceptor will handle auth expiry. Avoid noisy UI.\n}}catch(e){// eslint-disable-next-line no-console\nconsole.error('History save network error:',e);// silence network errors for history save to avoid user confusion\n}};const handleFinish=async()=>{// Ensure answers array is properly sized\nconst finalizedAnswers=Array.from({length:questions.length},(_,i)=>answers[i]!==undefined?answers[i]:null);if(answers.length===0||answers.length!==questions.length){setAnswers(finalizedAnswers);}// Calculate final scores\nlet correctCount=0;let incorrectCount=0;let unansweredCount=0;questions.forEach((question,idx)=>{const userAnswer=finalizedAnswers[idx];if(userAnswer===null||userAnswer===undefined||userAnswer===''){unansweredCount++;}else if(compareAnswers(userAnswer,question.correct)){correctCount++;}else{incorrectCount++;}});// Update state with calculated scores\nsetScore(correctCount);setMistakes(incorrectCount);setShowSummary(true);setReviewMode(false);setTimerPaused(true);// Permanently pause timer when exam is finished\nif(timerRef.current)clearInterval(timerRef.current);await saveToHistory({correct:correctCount,incorrect:incorrectCount,duration:time,answersArray:finalizedAnswers});};const handleCloseSummary=()=>{setShowSummary(false);setReviewMode(false);setCurrent(0);setSelected(null);setShowResult(false);setShowExplanation(false);setScore(0);setMistakes(0);setTime(0);setAnswers([]);};const handleAddRanking=()=>{// Check if user is logged in\nconst token=localStorage.getItem('token');if(!token){// Redirect to login page if not logged in\nnavigate('/login');return;}// Determine current level from route\nlet examLevel;if(testId==='dynamic-a1')examLevel='A1';else if(testId==='dynamic-a2'||testId==='dynamic')examLevel='A2';else if(testId==='dynamic-b1')examLevel='B1';else if(testId==='dynamic-b2')examLevel='B2';// Send all relevant exam result data to backend\nconst categoryId=q.categoryId;const seriesId=q.seriesId;fetch('http://localhost:4000/api/rankings',{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${token}`},body:JSON.stringify({score,time,categoryId,seriesId,correct:score,mistakes})}).then(async res=>{let data;try{data=await res.json();}catch(e){data={};}if(!res.ok){var _data,_data2,_data3;console.error('Ranking save error:',data);let errorMessage='Sıralamaya eklenemedi: '+(((_data=data)===null||_data===void 0?void 0:_data.message)||res.statusText);// Auth-related errors\nif(((_data2=data)===null||_data2===void 0?void 0:_data2.message)==='Authorization header missing'||res.status===401){errorMessage='Sıralamaya eklemek için giriş yapmalısınız.';}// Backend may block creating ranking-only rows to prevent \"Detay Yok\" duplicates\nif(typeof((_data3=data)===null||_data3===void 0?void 0:_data3.error)==='string'&&data.error.includes('Detailed test record not found')){errorMessage='Önce sınavı başarıyla bitirip kaydettiğinizden emin olun, sonra sıralamaya ekleyin.';}alert(errorMessage);return;}setShowSummary(false);// Navigate to rankings filtered by the user's level\nnavigate(examLevel?`/rankings?exam=${examLevel}`:'/rankings');}).catch(err=>{console.error('Ranking save error:',err);alert('Failed to save ranking. Network error.');});};const prevQuestion=()=>{if(current>0){setCurrent(c=>c-1);setSelected(answers[current-1]||null);setShowResult(!!answers[current-1]);setShowExplanation(false);// If the previous question was already answered, keep timer paused\nsetTimerPaused(!!answers[current-1]);}};return/*#__PURE__*/_jsxs(Box,{sx:{minHeight:'100vh',bgcolor:'#b2ebf2',display:'flex',alignItems:'center',justifyContent:'center',position:'relative'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:{xs:'none',md:'flex'},position:'fixed',top:{md:84,lg:96},right:{md:20,lg:28},zIndex:1200,background:timerPaused?'linear-gradient(135deg, #ff6b6b 0%, #ffa500 100%)':'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',color:'#fff',px:{md:2,lg:2.5},py:{md:0.75,lg:1},borderRadius:3,fontWeight:800,fontSize:{md:16,lg:18},boxShadow:'0 10px 24px rgba(0,0,0,0.12)',alignItems:'center',backdropFilter:'blur(8px)',border:'1px solid rgba(255,255,255,0.25)',gap:1},\"aria-label\":\"exam-timer-desktop\",children:[timerPaused&&/*#__PURE__*/_jsx(\"span\",{children:\"\\u23F8\\uFE0F\"}),Math.floor(time/60),\":\",(time%60).toString().padStart(2,'0')]}),/*#__PURE__*/_jsx(IconButton,{sx:{display:{xs:'none',md:'inline-flex'},position:'absolute',left:{xs:8,md:32},top:'50%',transform:'translateY(-50%)',zIndex:2,background:current>0?'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.8) 100%)':'rgba(255,255,255,0.4)',color:current>0?'#00b894':'#bdc3c7',backdropFilter:'blur(10px)',border:'1px solid rgba(255, 255, 255, 0.2)',boxShadow:current>0?'0 8px 25px rgba(0, 184, 148, 0.2)':'0 4px 15px rgba(0, 0, 0, 0.1)',borderRadius:3,p:2,cursor:current>0?'pointer':'default',opacity:current>0?1:0.5,transition:'all 0.3s ease','&:hover':{transform:current>0?'translateY(-50%) translateX(-3px)':'translateY(-50%)',background:current>0?'linear-gradient(135deg, rgba(0, 184, 148, 0.1) 0%, rgba(0, 206, 201, 0.1) 100%)':'rgba(255,255,255,0.4)',boxShadow:current>0?'0 12px 30px rgba(0, 184, 148, 0.3)':'0 4px 15px rgba(0, 0, 0, 0.1)'}},onClick:prevQuestion,disabled:current===0,children:/*#__PURE__*/_jsx(ArrowBackIcon,{fontSize:\"large\"})}),/*#__PURE__*/_jsx(IconButton,{sx:{display:{xs:'none',md:'inline-flex'},position:'absolute',right:{xs:8,md:32},top:'50%',transform:'translateY(-50%)',zIndex:2,background:current<questions.length-1?'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.8) 100%)':'rgba(255,255,255,0.4)',color:current<questions.length-1?'#00b894':'#bdc3c7',backdropFilter:'blur(10px)',border:'1px solid rgba(255, 255, 255, 0.2)',boxShadow:current<questions.length-1?'0 8px 25px rgba(0, 184, 148, 0.2)':'0 4px 15px rgba(0, 0, 0, 0.1)',borderRadius:3,p:2,cursor:current<questions.length-1?'pointer':'default',opacity:current<questions.length-1?1:0.5,transition:'all 0.3s ease','&:hover':{transform:current<questions.length-1?'translateY(-50%) translateX(3px)':'translateY(-50%)',background:current<questions.length-1?'linear-gradient(135deg, rgba(0, 184, 148, 0.1) 0%, rgba(0, 206, 201, 0.1) 100%)':'rgba(255,255,255,0.4)',boxShadow:current<questions.length-1?'0 12px 30px rgba(0, 184, 148, 0.3)':'0 4px 15px rgba(0, 0, 0, 0.1)'}},onClick:nextQuestion,disabled:current===questions.length-1,children:/*#__PURE__*/_jsx(ArrowForwardIcon,{fontSize:\"large\"})}),!reviewMode&&/*#__PURE__*/_jsxs(Paper,{elevation:6,sx:{p:{xs:2,sm:3,md:5},position:'relative',borderRadius:4,width:'100%',maxWidth:{xs:360,sm:560,md:600},background:'linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%)',backdropFilter:'blur(10px)',border:'1px solid rgba(255, 255, 255, 0.2)',boxShadow:'0 20px 40px rgba(0, 0, 0, 0.1)',transition:'transform 0.3s ease','&:hover':{transform:'translateY(-5px)'}},children:[/*#__PURE__*/_jsxs(Box,{sx:{position:'absolute',top:10,right:{xs:18,md:10},zIndex:2,display:{xs:'flex',md:'none'},background:timerPaused?'linear-gradient(135deg, #ff6b6b 0%, #ffa500 100%)':'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',color:'#fff',px:{xs:1.25,md:3},py:{xs:0.5,md:1},borderRadius:{xs:2,md:3},fontWeight:700,fontSize:{xs:13,md:18},boxShadow:'0 6px 16px rgba(0, 184, 148, 0.4)',alignItems:'center',backdropFilter:'blur(10px)',border:'1px solid rgba(255, 255, 255, 0.2)',gap:{xs:0.5,md:1},transition:'background-color 0.3s ease'},children:[timerPaused&&/*#__PURE__*/_jsx(\"span\",{children:\"\\u23F8\\uFE0F\"}),Math.floor(time/60),\":\",(time%60).toString().padStart(2,'0')]}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',alignItems:'center',mb:2},children:/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",fontWeight:700,align:\"center\",sx:{background:'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',backgroundClip:'text',WebkitBackgroundClip:'text',WebkitTextFillColor:'transparent',textShadow:'0 2px 4px rgba(0, 0, 0, 0.1)'},children:[\"Soru \",current+1,\" / \",questions.length]})}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",mb:3,sx:{color:'#2c3e50',fontWeight:600,fontSize:{xs:'1rem',sm:'1.1rem',md:'1.2rem'},lineHeight:1.6,textAlign:'center',p:{xs:1.25,sm:1.5,md:2},background:'rgba(255, 255, 255, 0.7)',borderRadius:'12px',border:'1px solid rgba(0, 184, 148, 0.2)'},children:q.text}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',flexDirection:'column',gap:2,mb:3},children:options.length>0?options.map((opt,idx)=>{const optionLetter=String.fromCharCode(65+idx);// A, B, C, D\nconst isSelected=selected===optionLetter;const isCorrect=compareAnswers(optionLetter,q.correct);const showColor=!!selected;return/*#__PURE__*/_jsxs(Button,{variant:isSelected?'contained':'outlined',color:showColor?isCorrect?'primary':isSelected?'error':'primary':'primary',sx:{textAlign:'left',fontWeight:600,fontSize:{xs:15,sm:16,md:18},textTransform:'none',borderRadius:4,py:{xs:1.25,sm:1.5,md:2},px:{xs:1.5,sm:2},background:!showColor?'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%)':isSelected?isCorrect?'linear-gradient(135deg, #00b894 0%, #00cec9 100%)':'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)':'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%)',color:showColor&&isSelected?'#ffffff':'#2c3e50',border:showColor&&isSelected?'none':'2px solid rgba(0, 184, 148, 0.3)',backdropFilter:'blur(10px)',boxShadow:isSelected?'0 8px 25px rgba(0, 184, 148, 0.3)':'0 4px 15px rgba(0, 0, 0, 0.1)',position:'relative',transition:'all 0.3s ease','&:hover':{transform:!selected?'translateY(-2px)':'none',background:!showColor?'linear-gradient(135deg, rgba(0, 184, 148, 0.1) 0%, rgba(0, 206, 201, 0.1) 100%)':undefined,boxShadow:!selected?'0 8px 25px rgba(0, 184, 148, 0.2)':undefined}},onClick:()=>!showResult&&handleSelect(idx),disabled:!!selected,children:[/*#__PURE__*/_jsxs(\"span\",{style:{position:'relative',zIndex:2},children:[String.fromCharCode(65+idx),\") \",formatText(opt)]}),showColor&&isSelected&&/*#__PURE__*/_jsx(\"span\",{style:{position:'absolute',right:16,top:'50%',transform:'translateY(-50%)',fontWeight:700,fontSize:14,color:'#ffffff',background:isCorrect?'linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)':'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)',borderRadius:12,padding:'4px 12px',boxShadow:'0 4px 12px rgba(0, 0, 0, 0.2)',zIndex:3},children:isCorrect?'✓ Doğru':'✗ Yanlış'})]},idx);}):/*#__PURE__*/_jsx(Typography,{color:\"error\",fontWeight:600,mb:2,children:\"Bu sorunun se\\xE7enekleri eksik veya hatal\\u0131.\"})}),showResult&&/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Typography,{color:\"success.main\",fontWeight:700,mb:1,children:compareAnswers(selected||'',q.correct)?'Doğru!':`Doğru Yanıt: ${getCorrectAnswerText()}`}),/*#__PURE__*/_jsx(Button,{variant:\"text\",onClick:()=>setShowExplanation(e=>!e),children:showExplanation?'Çözümü Gizle':'Çözümü Göster'}),showExplanation&&/*#__PURE__*/_jsx(Typography,{mt:2,color:\"text.secondary\",children:q.explanation})]}),!showSummary&&/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',justifyContent:{xs:'space-between',md:'center'},gap:1.5,mt:3},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:prevQuestion,disabled:current===0,sx:{textTransform:'none',fontWeight:700,borderWidth:2,borderColor:'#00b894',color:'#00b894','&:hover':{borderColor:'#00cec9',background:'rgba(0,206,201,0.08)'},display:{xs:'inline-flex',md:'none'}},children:\"\\xD6nceki\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleFinish,sx:{textTransform:'none',fontWeight:800,borderRadius:3,px:3,py:1.2,boxShadow:2,background:'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',color:'#fff','&:hover':{background:'linear-gradient(135deg, #00a085 0%, #00b8b3 100%)'}},children:\"Bitir\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:nextQuestion,disabled:current===questions.length-1,sx:{textTransform:'none',fontWeight:700,borderWidth:2,borderColor:'#00b894',color:'#00b894','&:hover':{borderColor:'#00cec9',background:'rgba(0,206,201,0.08)'},display:{xs:'inline-flex',md:'none'}},children:\"Sonraki\"})]})]}),showSummary&&/*#__PURE__*/_jsx(Box,{sx:{position:'fixed',top:0,left:0,width:'100vw',height:'100vh',bgcolor:'rgba(10,29,86,0.7)',zIndex:9999,display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsxs(Box,{sx:{bgcolor:'#fff',borderRadius:6,boxShadow:8,p:4,minWidth:320,maxWidth:'90vw',textAlign:'center',position:'relative'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",fontWeight:700,color:\"#19376D\",mb:2,children:\"S\\u0131nav Sonucu\"}),/*#__PURE__*/_jsxs(Typography,{fontSize:20,fontWeight:600,color:\"#43ea7c\",mb:1,children:[\"Do\\u011Fru: \",score]}),/*#__PURE__*/_jsxs(Typography,{fontSize:20,fontWeight:600,color:\"#e74c3c\",mb:1,children:[\"Yanl\\u0131\\u015F: \",mistakes]}),/*#__PURE__*/_jsxs(Typography,{fontSize:20,fontWeight:600,color:\"#f39c12\",mb:1,children:[\"Bo\\u015F: \",answers.filter(answer=>answer===null||answer===undefined||answer==='').length]}),/*#__PURE__*/_jsxs(Typography,{fontSize:18,fontWeight:500,color:\"#19376D\",mb:2,children:[\"S\\xFCre: \",Math.floor(time/60),\":\",(time%60).toString().padStart(2,'0')]}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',flexWrap:'wrap',gap:2,justifyContent:'center',mb:3},children:questions.map((question,idx)=>{const userAnswer=answers[idx];const isUnanswered=userAnswer===null||userAnswer===undefined||userAnswer==='';const isCorrect=!isUnanswered&&compareAnswers(userAnswer,question.correct);// Determine colors based on answer status\nlet borderColor,textColor,backgroundColor,hoverColor;if(isUnanswered){// Boş bırakılan sorular - turuncu\nborderColor='#f39c12';textColor='#f39c12';backgroundColor='#fdf6e3';hoverColor='#f8e49a';}else if(isCorrect){// Doğru cevaplar - yeşil\nborderColor='#43ea7c';textColor='#43ea7c';backgroundColor='#eafaf3';hoverColor='#c6f7e2';}else{// Yanlış cevaplar - kırmızı\nborderColor='#e74c3c';textColor='#e74c3c';backgroundColor='#fff0f0';hoverColor='#ffe3e3';}return/*#__PURE__*/_jsx(Button,{variant:\"outlined\",sx:{minWidth:48,height:48,fontWeight:700,fontSize:18,borderRadius:3,border:'none',color:'#ffffff',background:!answers[idx]?'linear-gradient(135deg, #f39c12 0%, #e67e22 100%)':isCorrect?'linear-gradient(135deg, #00b894 0%, #00cec9 100%)':'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)',backdropFilter:'blur(10px)',boxShadow:'0 6px 20px rgba(0, 0, 0, 0.15)',mx:0.5,my:0.5,transition:'all 0.3s ease','&:hover':{transform:'translateY(-3px)',boxShadow:'0 8px 25px rgba(0, 0, 0, 0.2)'}},onClick:()=>{setReviewMode(true);setShowSummary(false);setCurrent(idx);setSelected(answers[idx]||null);setShowResult(!!answers[idx]);setShowExplanation(false);},children:idx+1},idx);})}),/*#__PURE__*/_jsx(Typography,{fontSize:15,color:\"#19376D\",mb:2,children:\"Sorular\\u0131 incelemek i\\xE7in t\\u0131klay\\u0131n. Ye\\u015Fil: Do\\u011Fru, K\\u0131rm\\u0131z\\u0131: Yanl\\u0131\\u015F, Turuncu: Bo\\u015F\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'center',gap:2,mt:2,flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"success\",sx:{fontWeight:700,fontSize:16,borderRadius:3,px:4,py:1.2,boxShadow:2,textTransform:'none'},onClick:handleAddRanking,children:\"S\\u0131ralamaya Ekle\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"primary\",sx:{fontWeight:700,fontSize:16,borderRadius:3,px:4,py:1.2,boxShadow:2,textTransform:'none'},onClick:()=>{navigate('/categories');},children:\"Kapat\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",sx:{fontWeight:700,fontSize:16,borderRadius:3,px:4,py:1.2,boxShadow:2,textTransform:'none'},onClick:()=>{handleCloseSummary();},children:\"Tekrar \\xC7\\xF6z\"})]}),!localStorage.getItem('token')&&/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{display:'block',textAlign:'center',mt:1,fontSize:'0.75rem',color:'#666',fontStyle:'italic'},children:\"S\\u0131ralamaya eklemek i\\xE7in \\xFCye giri\\u015Fi gerekli veya kay\\u0131t olmal\\u0131s\\u0131n\\u0131z\"})]})}),reviewMode&&/*#__PURE__*/_jsxs(Paper,{elevation:6,sx:{p:5,borderRadius:4,minWidth:340,maxWidth:600,width:'100%',background:'linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%)',backdropFilter:'blur(10px)',border:'1px solid rgba(255, 255, 255, 0.2)',boxShadow:'0 20px 40px rgba(0, 0, 0, 0.1)',transition:'transform 0.3s ease','&:hover':{transform:'translateY(-5px)'}},children:[/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',alignItems:'center',mb:2},children:/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",fontWeight:700,align:\"center\",sx:{background:'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',backgroundClip:'text',WebkitBackgroundClip:'text',WebkitTextFillColor:'transparent',textShadow:'0 2px 4px rgba(0, 0, 0, 0.1)'},children:[\"Soru \",current+1,\" / \",questions.length,\" (\\u0130nceleme)\"]})}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",mb:3,sx:{color:'#2c3e50',fontWeight:600,fontSize:'1.2rem',lineHeight:1.6,textAlign:'center',padding:'16px',background:'rgba(255, 255, 255, 0.7)',borderRadius:'12px',border:'1px solid rgba(0, 184, 148, 0.2)'},children:q.text}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',flexDirection:'column',gap:2,mb:3},children:options.length>0?options.map((opt,idx)=>{const optionLetter=String.fromCharCode(65+idx);// A, B, C, D\nconst isSelected=answers[current]===optionLetter;const isCorrect=compareAnswers(optionLetter,q.correct);const showColor=!!answers[current];return/*#__PURE__*/_jsxs(Button,{variant:isSelected?'contained':'outlined',color:showColor?isCorrect?'primary':isSelected?'error':'primary':'primary',sx:{textAlign:'left',fontWeight:600,fontSize:18,borderRadius:4,py:2,px:2,background:!showColor?'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%)':isSelected?isCorrect?'linear-gradient(135deg, #00b894 0%, #00cec9 100%)':'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)':isCorrect?'linear-gradient(135deg, rgba(0, 184, 148, 0.1) 0%, rgba(0, 206, 201, 0.1) 100%)':'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%)',color:showColor&&isSelected?'#ffffff':isCorrect&&showColor?'#00b894':'#2c3e50',border:isCorrect&&showColor&&!isSelected?'2px solid #00b894':showColor&&isSelected?'none':'2px solid rgba(0, 184, 148, 0.3)',backdropFilter:'blur(10px)',boxShadow:isSelected?'0 8px 25px rgba(0, 184, 148, 0.3)':isCorrect&&showColor?'0 4px 15px rgba(0, 184, 148, 0.2)':'0 4px 15px rgba(0, 0, 0, 0.1)',position:'relative',transition:'all 0.3s ease',pointerEvents:'none'},disabled:true,children:[/*#__PURE__*/_jsxs(\"span\",{style:{position:'relative',zIndex:2},children:[String.fromCharCode(65+idx),\") \",opt]}),showColor&&isSelected&&/*#__PURE__*/_jsx(\"span\",{style:{position:'absolute',right:16,top:'50%',transform:'translateY(-50%)',fontWeight:700,fontSize:18,color:isCorrect?'#43ea7c':'#e74c3c',background:isCorrect?'#eafaf3':'#fff0f0',borderRadius:8,padding:'2px 12px',boxShadow:'0 2px 8px rgba(67,234,124,0.08)',zIndex:3},children:isCorrect?'Doğru':'Yanlış'})]},idx);}):/*#__PURE__*/_jsx(Typography,{color:\"error\",fontWeight:600,mb:2,children:\"Bu sorunun se\\xE7enekleri eksik veya hatal\\u0131.\"})}),!!q.explanation&&/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Button,{variant:\"text\",onClick:()=>setShowExplanation(e=>!e),children:showExplanation?'Çözümü Gizle':'Çözümü Göster'}),showExplanation&&/*#__PURE__*/_jsx(Typography,{mt:2,color:\"text.secondary\",children:q.explanation})]}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',mt:4},children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"primary\",sx:{fontWeight:700,fontSize:16,borderRadius:3,px:4,py:1.2,boxShadow:2,textTransform:'none'},onClick:()=>{setReviewMode(false);setShowSummary(true);setShowExplanation(false);},children:\"Sonu\\xE7lara D\\xF6n\"})})]})]});};export default Exam;","map":{"version":3,"names":["React","useEffect","useState","useRef","useParams","useLocation","useNavigate","Box","Paper","Typography","Button","CircularProgress","IconButton","ArrowBackIcon","ArrowForwardIcon","jsx","_jsx","jsxs","_jsxs","Exam","testId","location","navigate","questions","setQuestions","loading","setLoading","current","setCurrent","selected","setSelected","showResult","setShowResult","showExplanation","setShowExplanation","score","setScore","mistakes","setMistakes","showSummary","setShowSummary","time","setTime","reviewMode","setReviewMode","answers","setAnswers","timerPaused","setTimerPaused","timerRef","error","setError","formatText","text","length","charAt","toUpperCase","slice","toLowerCase","compareAnswers","answer1","answer2","_location$state","state","API_URL","process","env","REACT_APP_API_URL","apiUrl","startsWith","params","URLSearchParams","set","toString","console","log","fetch","then","res","status","ok","Error","json","data","questionsData","formattedQuestions","map","q","optionsArray","Array","isArray","options","JSON","parse","correctLetter","correct","correctIndex","findIndex","option","String","fromCharCode","catch","fill","setInterval","t","clearInterval","sx","minHeight","bgcolor","display","alignItems","justifyContent","children","p","borderRadius","background","boxShadow","textAlign","color","mb","variant","fontWeight","onClick","window","reload","align","mt","getCorrectAnswerText","charCodeAt","correctText","handleSelect","optionIndex","selectedLetter","prev","copy","s","m","nextQuestion","c","saveToHistory","payload","token","localStorage","getItem","_questions$","_questions$2","_questions$3","_questions$4","method","headers","body","stringify","category","categoryId","seriesId","duration","incorrect","idx","questionId","id","userAnswer","answersArray","isCorrect","ua","e","statusText","handleFinish","finalizedAnswers","from","_","i","undefined","correctCount","incorrectCount","unansweredCount","forEach","question","handleCloseSummary","handleAddRanking","examLevel","Authorization","_data","_data2","_data3","errorMessage","message","includes","alert","err","prevQuestion","position","xs","md","top","lg","right","zIndex","px","py","fontSize","backdropFilter","border","gap","Math","floor","padStart","left","transform","cursor","opacity","transition","disabled","elevation","sm","width","maxWidth","backgroundClip","WebkitBackgroundClip","WebkitTextFillColor","textShadow","lineHeight","flexDirection","opt","optionLetter","isSelected","showColor","textTransform","style","padding","explanation","borderWidth","borderColor","height","minWidth","filter","answer","flexWrap","isUnanswered","textColor","backgroundColor","hoverColor","mx","my","fontStyle","pointerEvents"],"sources":["/Users/yavuz/Desktop/portfolio/erasmus-exam-page/frontend/src/pages/Exam.tsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { useParams, useLocation, useNavigate } from 'react-router-dom';\nimport { Box, Paper, Typography, Button, CircularProgress, IconButton } from '@mui/material';\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\nimport ArrowForwardIcon from '@mui/icons-material/ArrowForward';\n\ninterface Question {\n  id: string;\n  text: string;\n  options: string[];\n  correct: string;\n  explanation: string;\n  categoryId: number;\n  seriesId: string;\n}\n\nconst Exam: React.FC = () => {\n  const { testId } = useParams();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const [questions, setQuestions] = useState<Question[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [current, setCurrent] = useState(0);\n  const [selected, setSelected] = useState<string | null>(null);\n  const [showResult, setShowResult] = useState(false);\n  const [showExplanation, setShowExplanation] = useState(false);\n  const [score, setScore] = useState(0);\n  const [mistakes, setMistakes] = useState(0);\n  const [showSummary, setShowSummary] = useState(false);\n  const [time, setTime] = useState(0);\n  const [reviewMode, setReviewMode] = useState(false);\n  const [answers, setAnswers] = useState<(string | null)[]>([]);\n  const [timerPaused, setTimerPaused] = useState(false);\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  // Helper function to format text: first letter uppercase, rest lowercase\n  const formatText = (text: string) => {\n    if (!text || text.length === 0) return text;\n    return text.charAt(0).toUpperCase() + text.slice(1).toLowerCase();\n  };\n\n  // Helper function for case insensitive comparison\n  const compareAnswers = (answer1: string, answer2: string) => {\n    return answer1.toLowerCase() === answer2.toLowerCase();\n  };\n\n  useEffect(() => {\n    // Fetch if no state or empty state provided\n    if (!location.state?.questions || location.state.questions.length === 0) {\n      setLoading(true);\n      setError(null);\n      \n      // For dynamic tests, use the questions endpoint directly with filters\n      const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:4000';\n      let apiUrl: string;\n      \n      if (testId === 'dynamic' || testId?.startsWith('dynamic-')) {\n        apiUrl = `${API_URL}/api/questions`;\n\n        // Add category filter based on testId and lock series to Erasmus Sınavı\n        // so Üniversite Hazırlık soruları dinamik Erasmus kartlarına karışmasın.\n        const params = new URLSearchParams();\n        if (testId === 'dynamic-a1') {\n          params.set('category', 'A1');\n        } else if (testId === 'dynamic-a2' || testId === 'dynamic') {\n          params.set('category', 'A2');\n        } else if (testId === 'dynamic-b1') {\n          params.set('category', 'B1');\n        } else if (testId === 'dynamic-b2') {\n          params.set('category', 'B2');\n        }\n        // Restrict to Erasmus series explicitly\n        params.set('series', 'Erasmus Sınavı');\n        apiUrl += `?${params.toString()}`;\n      } else {\n        apiUrl = `${API_URL}/api/tests/${testId}/questions`;\n      }\n      \n      console.log(`Fetching questions from: ${apiUrl}`);\n      \n      fetch(apiUrl)\n        .then(res => {\n          console.log('API Response status:', res.status);\n          if (!res.ok) {\n            throw new Error(`Request failed with status ${res.status}`);\n          }\n          return res.json();\n        })\n        .then(data => {\n          console.log('API Response data:', data);\n          const questionsData = data.questions || data || [];\n          console.log('Questions data length:', questionsData.length);\n          \n          const formattedQuestions = questionsData.map((q: Question) => {\n            // Parse options if they're in string format\n            let optionsArray: string[] = [];\n            if (Array.isArray(q.options)) {\n              optionsArray = q.options.map(formatText);\n            } else if (typeof q.options === 'string') {\n              try {\n                optionsArray = JSON.parse(q.options).map(formatText);\n              } catch {\n                optionsArray = [];\n              }\n            }\n\n            // Convert correct answer to letter if it's a word\n            let correctLetter = q.correct;\n            if (q.correct && q.correct.length > 1) {\n              // If correct is a word, find its index in options and convert to letter\n              const correctIndex = optionsArray.findIndex(option => \n                option.toLowerCase() === q.correct.toLowerCase()\n              );\n              if (correctIndex !== -1) {\n                correctLetter = String.fromCharCode(65 + correctIndex); // A, B, C, D\n                console.log(`Converted \"${q.correct}\" to letter \"${correctLetter}\"`);\n              }\n            }\n\n            return {\n              ...q,\n              options: optionsArray,\n              correct: correctLetter\n            };\n          });\n          console.log(`Loaded ${formattedQuestions.length} questions`);\n          setQuestions(formattedQuestions);\n          setLoading(false);\n        })\n        .catch(error => {\n          console.error('Failed to fetch questions:', error);\n          setError('Sunucuya ulaşılamıyor. Lütfen sunucuyu başlatıp tekrar deneyin.');\n          setLoading(false);\n        });\n    } else {\n      // Format questions from state as well\n      const formattedQuestions = location.state.questions.map((q: Question) => {\n        // Parse options if they're in string format\n        let optionsArray: string[] = [];\n        if (Array.isArray(q.options)) {\n          optionsArray = q.options.map(formatText);\n        } else if (typeof q.options === 'string') {\n          try {\n            optionsArray = JSON.parse(q.options).map(formatText);\n          } catch {\n            optionsArray = [];\n          }\n        }\n\n        // Convert correct answer to letter if it's a word\n        let correctLetter = q.correct;\n        if (q.correct && q.correct.length > 1) {\n          // If correct is a word, find its index in options and convert to letter\n          const correctIndex = optionsArray.findIndex(option => \n            option.toLowerCase() === q.correct.toLowerCase()\n          );\n          if (correctIndex !== -1) {\n            correctLetter = String.fromCharCode(65 + correctIndex); // A, B, C, D\n            console.log(`Converted \"${q.correct}\" to letter \"${correctLetter}\"`);\n          }\n        }\n\n        return {\n          ...q,\n          options: optionsArray,\n          correct: correctLetter\n        };\n      });\n      setQuestions(formattedQuestions);\n      setLoading(false);\n    }\n  }, [location.state, testId]);\n\n  // Initialize answers array when questions are loaded\n  useEffect(() => {\n    if (questions.length > 0 && answers.length !== questions.length) {\n      setAnswers(Array(questions.length).fill(null));\n    }\n  }, [questions, answers.length]);\n\n  // Timer logic - pause when answer is selected or exam is finished\n  useEffect(() => {\n    if (showSummary || timerPaused) return;\n    timerRef.current = setInterval(() => {\n      setTime((t) => t + 1);\n    }, 1000);\n    return () => {\n      if (timerRef.current) clearInterval(timerRef.current);\n    };\n  }, [showSummary, timerPaused]);\n\n  if (loading) {\n    return (\n      <Box sx={{ minHeight: '100vh', bgcolor: '#b2ebf2', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n        <Box sx={{\n          p: 4,\n          borderRadius: 4,\n          background: 'linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)',\n          boxShadow: '0 20px 40px rgba(0,0,0,0.1)',\n          textAlign: 'center'\n        }}>\n          <CircularProgress sx={{ color: '#00b894', mb: 2 }} />\n          <Typography variant=\"h6\" sx={{ color: '#2c3e50', fontWeight: 600 }}>\n            Sorular Yükleniyor...\n          </Typography>\n        </Box>\n      </Box>\n    );\n  }\n\n  if (error) {\n    return (\n      <Box sx={{ minHeight: '100vh', bgcolor: '#b2ebf2', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n        <Box sx={{ p: 4, borderRadius: 4, background: 'linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%)', boxShadow: '0 20px 40px rgba(0,0,0,0.1)', textAlign: 'center' }}>\n          <Typography variant=\"h6\" sx={{ color: '#c62828', fontWeight: 600, mb: 2 }}>{error}</Typography>\n          <Button variant=\"contained\" onClick={() => window.location.reload()}>Tekrar Dene</Button>\n        </Box>\n      </Box>\n    );\n  }\n\n  if (!questions.length) {\n    return <Typography align=\"center\" mt={8}>Bu sınav için soru bulunamadı.</Typography>;\n  }\n\n  const q = questions[current];\n  // Ensure options is always an array\n  let options: string[] = [];\n  if (Array.isArray(q.options)) {\n    options = q.options;\n  } else if (typeof q.options === 'string') {\n    try {\n      options = JSON.parse(q.options);\n    } catch {\n      options = [];\n    }\n  }\n\n  // Helper function to get correct answer text\n  const getCorrectAnswerText = () => {\n    if (!q.correct || options.length === 0) return q.correct;\n    const correctIndex = q.correct.charCodeAt(0) - 65; // A=0, B=1, C=2, D=3\n    const correctText = options[correctIndex];\n    return correctText ? `${q.correct}) ${correctText}` : q.correct;\n  };\n\n  const handleSelect = (optionIndex: number) => {\n    const selectedLetter = String.fromCharCode(65 + optionIndex); // 0->A, 1->B, 2->C, 3->D\n    console.log('Selected option index:', optionIndex);\n    console.log('Selected letter:', selectedLetter);\n    console.log('Question correct answer:', q.correct);\n    console.log('Question correct answer type:', typeof q.correct);\n    \n    setSelected(selectedLetter);\n    setShowResult(true);\n    setTimerPaused(true); // Pause timer when answer is selected\n    setAnswers((prev) => {\n      const copy = [...prev];\n      copy[current] = selectedLetter;\n      return copy;\n    });\n    if (compareAnswers(selectedLetter, q.correct)) {\n      setScore((s) => s + 1);\n    } else {\n      setMistakes((m) => m + 1);\n    }\n  };\n\n  const nextQuestion = () => {\n    if (current < questions.length - 1) {\n      setCurrent(c => c + 1);\n      setSelected(answers[current + 1] || null);\n      setShowResult(!!answers[current + 1]);\n      setShowExplanation(false);\n      setTimerPaused(false); // Resume timer when moving to next question\n    }\n  };\n\n  // Sınavı history'ye kaydet (explicit payload to avoid stale state)\n  const saveToHistory = async (payload?: { correct: number; incorrect: number; duration: number; answersArray: (string | null)[] }) => {\n  const token = localStorage.getItem('token');\n  // Kullanıcı giriş yapmadıysa history kaydı denemeyelim; sessizce çık\n  if (!token) return;\n    try {\n      const res = await fetch('http://localhost:4000/api/history', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(token ? { 'Authorization': `Bearer ${token}` } : {})\n        },\n        body: JSON.stringify({\n          category: typeof questions[0]?.categoryId === 'string' ? questions[0]?.categoryId : String(questions[0]?.categoryId),\n          seriesId: questions[0]?.seriesId || null,\n          duration: payload ? payload.duration : time,\n          correct: payload ? payload.correct : score,\n          incorrect: payload ? payload.incorrect : mistakes,\n          questions: questions.map((q, idx) => ({\n            questionId: q.id,\n            userAnswer: (payload ? payload.answersArray[idx] : answers[idx]),\n            isCorrect: (() => {\n              const ua = payload ? payload.answersArray[idx] : answers[idx];\n              return ua ? compareAnswers(ua!, q.correct) : false;\n            })()\n          }))\n        })\n      });\n      if (!res.ok) {\n        try {\n          const data = await res.json();\n          // eslint-disable-next-line no-console\n          console.error('History save error:', data);\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error('History save error (no json):', res.status, res.statusText);\n        }\n        // Do not alert here; interceptor will handle auth expiry. Avoid noisy UI.\n      }\n    } catch (e) {\n      // eslint-disable-next-line no-console\n  console.error('History save network error:', e);\n  // silence network errors for history save to avoid user confusion\n    }\n  };\n\n  const handleFinish = async () => {\n    // Ensure answers array is properly sized\n    const finalizedAnswers = Array.from({ length: questions.length }, (_, i) => (answers[i] !== undefined ? answers[i] : null));\n    if (answers.length === 0 || answers.length !== questions.length) {\n      setAnswers(finalizedAnswers);\n    }\n    \n    // Calculate final scores\n    let correctCount = 0;\n    let incorrectCount = 0;\n    let unansweredCount = 0;\n    \n    questions.forEach((question, idx) => {\n      const userAnswer = finalizedAnswers[idx];\n      if (userAnswer === null || userAnswer === undefined || userAnswer === '') {\n        unansweredCount++;\n      } else if (compareAnswers(userAnswer, question.correct)) {\n        correctCount++;\n      } else {\n        incorrectCount++;\n      }\n    });\n    \n    // Update state with calculated scores\n    setScore(correctCount);\n    setMistakes(incorrectCount);\n    \n    setShowSummary(true);\n    setReviewMode(false);\n    setTimerPaused(true); // Permanently pause timer when exam is finished\n    if (timerRef.current) clearInterval(timerRef.current);\n    \n    await saveToHistory({\n      correct: correctCount,\n      incorrect: incorrectCount,\n      duration: time,\n      answersArray: finalizedAnswers,\n    });\n  };\n\n  const handleCloseSummary = () => {\n    setShowSummary(false);\n    setReviewMode(false);\n    setCurrent(0);\n    setSelected(null);\n    setShowResult(false);\n    setShowExplanation(false);\n    setScore(0);\n    setMistakes(0);\n    setTime(0);\n    setAnswers([]);\n  };\n\n  const handleAddRanking = () => {\n    // Check if user is logged in\n    const token = localStorage.getItem('token');\n    if (!token) {\n      // Redirect to login page if not logged in\n      navigate('/login');\n      return;\n    }\n\n    // Determine current level from route\n    let examLevel: 'A1' | 'A2' | 'B1' | 'B2' | undefined;\n    if (testId === 'dynamic-a1') examLevel = 'A1';\n    else if (testId === 'dynamic-a2' || testId === 'dynamic') examLevel = 'A2';\n    else if (testId === 'dynamic-b1') examLevel = 'B1';\n    else if (testId === 'dynamic-b2') examLevel = 'B2';\n\n    // Send all relevant exam result data to backend\n    const categoryId = q.categoryId;\n    const seriesId = q.seriesId;\n    fetch('http://localhost:4000/api/rankings', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` },\n      body: JSON.stringify({ score, time, categoryId, seriesId, correct: score, mistakes }),\n    })\n      .then(async res => {\n        let data;\n        try {\n          data = await res.json();\n        } catch (e) {\n          data = {};\n        }\n        if (!res.ok) {\n          console.error('Ranking save error:', data);\n          let errorMessage = 'Sıralamaya eklenemedi: ' + (data?.message || res.statusText);\n\n          // Auth-related errors\n          if (data?.message === 'Authorization header missing' || res.status === 401) {\n            errorMessage = 'Sıralamaya eklemek için giriş yapmalısınız.';\n          }\n          // Backend may block creating ranking-only rows to prevent \"Detay Yok\" duplicates\n          if (typeof data?.error === 'string' && data.error.includes('Detailed test record not found')) {\n            errorMessage = 'Önce sınavı başarıyla bitirip kaydettiğinizden emin olun, sonra sıralamaya ekleyin.';\n          }\n\n          alert(errorMessage);\n          return;\n        }\n        setShowSummary(false);\n        // Navigate to rankings filtered by the user's level\n        navigate(examLevel ? `/rankings?exam=${examLevel}` : '/rankings');\n      })\n      .catch(err => {\n        console.error('Ranking save error:', err);\n        alert('Failed to save ranking. Network error.');\n      });\n  };\n\n  const prevQuestion = () => {\n    if (current > 0) {\n      setCurrent(c => c - 1);\n      setSelected(answers[current - 1] || null);\n      setShowResult(!!answers[current - 1]);\n      setShowExplanation(false);\n      // If the previous question was already answered, keep timer paused\n      setTimerPaused(!!answers[current - 1]);\n    }\n  };\n\n  return (\n    <Box sx={{ minHeight: '100vh', bgcolor: '#b2ebf2', display: 'flex', alignItems: 'center', justifyContent: 'center', position: 'relative' }}>\n      {/* Fixed timer for tablet/desktop (sticky at top-right) */}\n    <Box\n        sx={{\n          display: { xs: 'none', md: 'flex' },\n          position: 'fixed',\n      top: { md: 84, lg: 96 },\n          right: { md: 20, lg: 28 },\n          zIndex: 1200,\n          background: timerPaused\n            ? 'linear-gradient(135deg, #ff6b6b 0%, #ffa500 100%)'\n            : 'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',\n          color: '#fff',\n          px: { md: 2, lg: 2.5 },\n          py: { md: 0.75, lg: 1 },\n          borderRadius: 3,\n          fontWeight: 800,\n          fontSize: { md: 16, lg: 18 },\n          boxShadow: '0 10px 24px rgba(0,0,0,0.12)',\n          alignItems: 'center',\n          backdropFilter: 'blur(8px)',\n          border: '1px solid rgba(255,255,255,0.25)',\n          gap: 1\n        }}\n        aria-label=\"exam-timer-desktop\"\n      >\n        {timerPaused && <span>⏸️</span>}\n        {Math.floor(time / 60)}:{(time % 60).toString().padStart(2, '0')}\n      </Box>\n  {/* Timer now lives inside the main Paper (card) */}\n      {/* Navigation buttons outside the card */}\n      <IconButton\n        sx={{\n          display: { xs: 'none', md: 'inline-flex' },\n          position: 'absolute',\n          left: { xs: 8, md: 32 },\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2,\n          background: current > 0 \n            ? 'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.8) 100%)'\n            : 'rgba(255,255,255,0.4)',\n          color: current > 0 ? '#00b894' : '#bdc3c7',\n          backdropFilter: 'blur(10px)',\n          border: '1px solid rgba(255, 255, 255, 0.2)',\n          boxShadow: current > 0 ? '0 8px 25px rgba(0, 184, 148, 0.2)' : '0 4px 15px rgba(0, 0, 0, 0.1)',\n          borderRadius: 3,\n          p: 2,\n          cursor: current > 0 ? 'pointer' : 'default',\n          opacity: current > 0 ? 1 : 0.5,\n          transition: 'all 0.3s ease',\n          '&:hover': {\n            transform: current > 0 ? 'translateY(-50%) translateX(-3px)' : 'translateY(-50%)',\n            background: current > 0 \n              ? 'linear-gradient(135deg, rgba(0, 184, 148, 0.1) 0%, rgba(0, 206, 201, 0.1) 100%)'\n              : 'rgba(255,255,255,0.4)',\n            boxShadow: current > 0 ? '0 12px 30px rgba(0, 184, 148, 0.3)' : '0 4px 15px rgba(0, 0, 0, 0.1)',\n          },\n        }}\n        onClick={prevQuestion}\n        disabled={current === 0}\n      >\n        <ArrowBackIcon fontSize=\"large\" />\n      </IconButton>\n      <IconButton\n        sx={{\n          display: { xs: 'none', md: 'inline-flex' },\n          position: 'absolute',\n          right: { xs: 8, md: 32 },\n          top: '50%',\n          transform: 'translateY(-50%)',\n          zIndex: 2,\n          background: current < questions.length - 1 \n            ? 'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.8) 100%)'\n            : 'rgba(255,255,255,0.4)',\n          color: current < questions.length - 1 ? '#00b894' : '#bdc3c7',\n          backdropFilter: 'blur(10px)',\n          border: '1px solid rgba(255, 255, 255, 0.2)',\n          boxShadow: current < questions.length - 1 ? '0 8px 25px rgba(0, 184, 148, 0.2)' : '0 4px 15px rgba(0, 0, 0, 0.1)',\n          borderRadius: 3,\n          p: 2,\n          cursor: current < questions.length - 1 ? 'pointer' : 'default',\n          opacity: current < questions.length - 1 ? 1 : 0.5,\n          transition: 'all 0.3s ease',\n          '&:hover': {\n            transform: current < questions.length - 1 ? 'translateY(-50%) translateX(3px)' : 'translateY(-50%)',\n            background: current < questions.length - 1 \n              ? 'linear-gradient(135deg, rgba(0, 184, 148, 0.1) 0%, rgba(0, 206, 201, 0.1) 100%)'\n              : 'rgba(255,255,255,0.4)',\n            boxShadow: current < questions.length - 1 ? '0 12px 30px rgba(0, 184, 148, 0.3)' : '0 4px 15px rgba(0, 0, 0, 0.1)',\n          },\n        }}\n        onClick={nextQuestion}\n        disabled={current === questions.length - 1}\n      >\n        <ArrowForwardIcon fontSize=\"large\" />\n      </IconButton>\n      {!reviewMode && (\n        <Paper \n          elevation={6} \n          sx={{ \n            p: { xs: 2, sm: 3, md: 5 },\n            position: 'relative',\n            borderRadius: 4, \n            width: '100%', \n            maxWidth: { xs: 360, sm: 560, md: 600 },\n            background: 'linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%)',\n            backdropFilter: 'blur(10px)',\n            border: '1px solid rgba(255, 255, 255, 0.2)',\n            boxShadow: '0 20px 40px rgba(0, 0, 0, 0.1)',\n            transition: 'transform 0.3s ease',\n            '&:hover': {\n              transform: 'translateY(-5px)',\n            }\n          }}\n        >\n      {/* Inset timer at top-right inside the card (mobile only) */}\n          <Box\n            sx={{\n              position: 'absolute',\n              top: 10,\n              right: { xs: 18, md: 10 },\n              zIndex: 2,\n        display: { xs: 'flex', md: 'none' },\n              background: timerPaused \n                ? 'linear-gradient(135deg, #ff6b6b 0%, #ffa500 100%)' \n                : 'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',\n              color: '#fff',\n              px: { xs: 1.25, md: 3 },\n              py: { xs: 0.5, md: 1 },\n              borderRadius: { xs: 2, md: 3 },\n              fontWeight: 700,\n              fontSize: { xs: 13, md: 18 },\n              boxShadow: '0 6px 16px rgba(0, 184, 148, 0.4)',\n              alignItems: 'center',\n              backdropFilter: 'blur(10px)',\n              border: '1px solid rgba(255, 255, 255, 0.2)',\n              gap: { xs: 0.5, md: 1 },\n              transition: 'background-color 0.3s ease',\n            }}\n          >\n            {timerPaused && <span>⏸️</span>}\n            {Math.floor(time / 60)}:{(time % 60).toString().padStart(2, '0')}\n          </Box>\n          <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', mb: 2 }}>\n            <Typography \n              variant=\"h5\" \n              fontWeight={700} \n              align=\"center\"\n              sx={{\n                background: 'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',\n                backgroundClip: 'text',\n                WebkitBackgroundClip: 'text',\n                WebkitTextFillColor: 'transparent',\n                textShadow: '0 2px 4px rgba(0, 0, 0, 0.1)',\n              }}\n            >\n              Soru {current + 1} / {questions.length}\n            </Typography>\n          </Box>\n          <Typography \n            variant=\"h6\" \n            mb={3}\n            sx={{\n              color: '#2c3e50',\n              fontWeight: 600,\n              fontSize: { xs: '1rem', sm: '1.1rem', md: '1.2rem' },\n              lineHeight: 1.6,\n              textAlign: 'center',\n              p: { xs: 1.25, sm: 1.5, md: 2 },\n              background: 'rgba(255, 255, 255, 0.7)',\n              borderRadius: '12px',\n              border: '1px solid rgba(0, 184, 148, 0.2)',\n            }}\n          >\n            {q.text}\n          </Typography>\n          <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2, mb: 3 }}>\n            {options.length > 0 ? (\n              options.map((opt, idx) => {\n                const optionLetter = String.fromCharCode(65 + idx); // A, B, C, D\n                const isSelected = selected === optionLetter;\n                const isCorrect = compareAnswers(optionLetter, q.correct);\n                const showColor = !!selected;\n                return (\n          <Button\n                    key={idx}\n                    variant={isSelected ? 'contained' : 'outlined'}\n                    color={showColor ? (isCorrect ? 'primary' : isSelected ? 'error' : 'primary') : 'primary'}\n                    sx={{\n                      textAlign: 'left',\n                      fontWeight: 600,\n            fontSize: { xs: 15, sm: 16, md: 18 },\n                      textTransform: 'none',\n                      borderRadius: 4,\n            py: { xs: 1.25, sm: 1.5, md: 2 },\n            px: { xs: 1.5, sm: 2 },\n                      background: !showColor \n                        ? 'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%)'\n                        : isSelected\n                          ? (isCorrect\n                              ? 'linear-gradient(135deg, #00b894 0%, #00cec9 100%)'\n                              : 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)')\n                          : 'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%)',\n                      color: showColor && isSelected ? '#ffffff' : '#2c3e50',\n                      border: showColor && isSelected\n                        ? 'none'\n                        : '2px solid rgba(0, 184, 148, 0.3)',\n                      backdropFilter: 'blur(10px)',\n                      boxShadow: isSelected \n                        ? '0 8px 25px rgba(0, 184, 148, 0.3)' \n                        : '0 4px 15px rgba(0, 0, 0, 0.1)',\n                      position: 'relative',\n                      transition: 'all 0.3s ease',\n                      '&:hover': {\n                        transform: !selected ? 'translateY(-2px)' : 'none',\n                        background: !showColor \n                          ? 'linear-gradient(135deg, rgba(0, 184, 148, 0.1) 0%, rgba(0, 206, 201, 0.1) 100%)' \n                          : undefined,\n                        boxShadow: !selected \n                          ? '0 8px 25px rgba(0, 184, 148, 0.2)' \n                          : undefined,\n                      },\n                    }}\n                    onClick={() => !showResult && handleSelect(idx)}\n                    disabled={!!selected}\n                  >\n                    <span style={{ position: 'relative', zIndex: 2 }}>{String.fromCharCode(65 + idx)}) {formatText(opt)}</span>\n                    {showColor && isSelected && (\n                      <span style={{\n                        position: 'absolute',\n                        right: 16,\n                        top: '50%',\n                        transform: 'translateY(-50%)',\n                        fontWeight: 700,\n                        fontSize: 14,\n                        color: '#ffffff',\n                        background: isCorrect \n                          ? 'linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)' \n                          : 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)',\n                        borderRadius: 12,\n                        padding: '4px 12px',\n                        boxShadow: '0 4px 12px rgba(0, 0, 0, 0.2)',\n                        zIndex: 3,\n                      }}>\n                        {isCorrect ? '✓ Doğru' : '✗ Yanlış'}\n                      </span>\n                    )}\n                  </Button>\n                );\n              })\n            ) : (\n              <Typography color=\"error\" fontWeight={600} mb={2}>Bu sorunun seçenekleri eksik veya hatalı.</Typography>\n            )}\n          </Box>\n          {showResult && (\n            <Box sx={{ mb: 2 }}>\n              <Typography color=\"success.main\" fontWeight={700} mb={1}>\n                {compareAnswers(selected || '', q.correct) ? 'Doğru!' : `Doğru Yanıt: ${getCorrectAnswerText()}`}\n              </Typography>\n              <Button variant=\"text\" onClick={() => setShowExplanation(e => !e)}>\n                {showExplanation ? 'Çözümü Gizle' : 'Çözümü Göster'}\n              </Button>\n              {showExplanation && (\n                <Typography mt={2} color=\"text.secondary\">{q.explanation}</Typography>\n              )}\n            </Box>\n          )}\n          {/* Bottom controls: mobile shows Önceki/Bitir/Sonraki, desktop shows only Bitir */}\n          {!showSummary && (\n            <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: { xs: 'space-between', md: 'center' }, gap: 1.5, mt: 3 }}>\n              <Button\n                variant=\"outlined\"\n                onClick={prevQuestion}\n                disabled={current === 0}\n                sx={{\n                  textTransform: 'none',\n                  fontWeight: 700,\n                  borderWidth: 2,\n                  borderColor: '#00b894',\n                  color: '#00b894',\n                  '&:hover': { borderColor: '#00cec9', background: 'rgba(0,206,201,0.08)' },\n                  display: { xs: 'inline-flex', md: 'none' },\n                }}\n              >\n                Önceki\n              </Button>\n              <Button\n                variant=\"contained\"\n                onClick={handleFinish}\n                sx={{\n                  textTransform: 'none',\n                  fontWeight: 800,\n                  borderRadius: 3,\n                  px: 3,\n                  py: 1.2,\n                  boxShadow: 2,\n                  background: 'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',\n                  color: '#fff',\n                  '&:hover': { background: 'linear-gradient(135deg, #00a085 0%, #00b8b3 100%)' }\n                }}\n              >\n                Bitir\n              </Button>\n              <Button\n                variant=\"outlined\"\n                onClick={nextQuestion}\n                disabled={current === questions.length - 1}\n                sx={{\n                  textTransform: 'none',\n                  fontWeight: 700,\n                  borderWidth: 2,\n                  borderColor: '#00b894',\n                  color: '#00b894',\n                  '&:hover': { borderColor: '#00cec9', background: 'rgba(0,206,201,0.08)' },\n                  display: { xs: 'inline-flex', md: 'none' },\n                }}\n              >\n                Sonraki\n              </Button>\n            </Box>\n          )}\n        </Paper>\n      )}\n      {/* Result popup bubble with question review */}\n      {showSummary && (\n        <Box sx={{ position: 'fixed', top: 0, left: 0, width: '100vw', height: '100vh', bgcolor: 'rgba(10,29,86,0.7)', zIndex: 9999, display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n          <Box sx={{ bgcolor: '#fff', borderRadius: 6, boxShadow: 8, p: 4, minWidth: 320, maxWidth: '90vw', textAlign: 'center', position: 'relative' }}>\n            <Typography variant=\"h5\" fontWeight={700} color=\"#19376D\" mb={2}>Sınav Sonucu</Typography>\n            <Typography fontSize={20} fontWeight={600} color=\"#43ea7c\" mb={1}>Doğru: {score}</Typography>\n            <Typography fontSize={20} fontWeight={600} color=\"#e74c3c\" mb={1}>Yanlış: {mistakes}</Typography>\n            <Typography fontSize={20} fontWeight={600} color=\"#f39c12\" mb={1}>Boş: {answers.filter(answer => answer === null || answer === undefined || answer === '').length}</Typography>\n            <Typography fontSize={18} fontWeight={500} color=\"#19376D\" mb={2}>Süre: {Math.floor(time / 60)}:{(time % 60).toString().padStart(2, '0')}</Typography>\n            {/* Question review list */}\n            <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 2, justifyContent: 'center', mb: 3 }}>\n              {questions.map((question, idx) => {\n                const userAnswer = answers[idx];\n                const isUnanswered = userAnswer === null || userAnswer === undefined || userAnswer === '';\n                const isCorrect = !isUnanswered && compareAnswers(userAnswer, question.correct);\n                \n                // Determine colors based on answer status\n                let borderColor, textColor, backgroundColor, hoverColor;\n                if (isUnanswered) {\n                  // Boş bırakılan sorular - turuncu\n                  borderColor = '#f39c12';\n                  textColor = '#f39c12';\n                  backgroundColor = '#fdf6e3';\n                  hoverColor = '#f8e49a';\n                } else if (isCorrect) {\n                  // Doğru cevaplar - yeşil\n                  borderColor = '#43ea7c';\n                  textColor = '#43ea7c';\n                  backgroundColor = '#eafaf3';\n                  hoverColor = '#c6f7e2';\n                } else {\n                  // Yanlış cevaplar - kırmızı\n                  borderColor = '#e74c3c';\n                  textColor = '#e74c3c';\n                  backgroundColor = '#fff0f0';\n                  hoverColor = '#ffe3e3';\n                }\n                \n                return (\n                  <Button\n                    key={idx}\n                    variant=\"outlined\"\n                    sx={{\n                      minWidth: 48,\n                      height: 48,\n                      fontWeight: 700,\n                      fontSize: 18,\n                      borderRadius: 3,\n                      border: 'none',\n                      color: '#ffffff',\n                      background: !answers[idx] \n                        ? 'linear-gradient(135deg, #f39c12 0%, #e67e22 100%)'\n                        : isCorrect\n                          ? 'linear-gradient(135deg, #00b894 0%, #00cec9 100%)'\n                          : 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)',\n                      backdropFilter: 'blur(10px)',\n                      boxShadow: '0 6px 20px rgba(0, 0, 0, 0.15)',\n                      mx: 0.5,\n                      my: 0.5,\n                      transition: 'all 0.3s ease',\n                      '&:hover': {\n                        transform: 'translateY(-3px)',\n                        boxShadow: '0 8px 25px rgba(0, 0, 0, 0.2)',\n                      },\n                    }}\n                    onClick={() => {\n                      setReviewMode(true);\n                      setShowSummary(false);\n                      setCurrent(idx);\n                      setSelected(answers[idx] || null);\n                      setShowResult(!!answers[idx]);\n                      setShowExplanation(false);\n                    }}\n                  >\n                    {idx + 1}\n                  </Button>\n                );\n              })}\n            </Box>\n            <Typography fontSize={15} color=\"#19376D\" mb={2}>\n              Soruları incelemek için tıklayın. Yeşil: Doğru, Kırmızı: Yanlış, Turuncu: Boş\n            </Typography>\n            {/* Action buttons */}\n            <Box sx={{ display: 'flex', justifyContent: 'center', gap: 2, mt: 2, flexWrap: 'wrap' }}>\n              <Button\n                variant=\"contained\"\n                color=\"success\"\n                sx={{ fontWeight: 700, fontSize: 16, borderRadius: 3, px: 4, py: 1.2, boxShadow: 2, textTransform: 'none' }}\n                onClick={handleAddRanking}\n              >\n                Sıralamaya Ekle\n              </Button>\n              <Button\n                variant=\"outlined\"\n                color=\"primary\"\n                sx={{ fontWeight: 700, fontSize: 16, borderRadius: 3, px: 4, py: 1.2, boxShadow: 2, textTransform: 'none' }}\n                onClick={() => {\n                  navigate('/categories');\n                }}\n              >\n                Kapat\n              </Button>\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                sx={{ fontWeight: 700, fontSize: 16, borderRadius: 3, px: 4, py: 1.2, boxShadow: 2, textTransform: 'none' }}\n                onClick={() => {\n                  handleCloseSummary();\n                }}\n              >\n                Tekrar Çöz\n              </Button>\n            </Box>\n            {/* Login warning text */}\n            {!localStorage.getItem('token') && (\n              <Typography \n                variant=\"caption\" \n                sx={{ \n                  display: 'block',\n                  textAlign: 'center', \n                  mt: 1, \n                  fontSize: '0.75rem',\n                  color: '#666',\n                  fontStyle: 'italic'\n                }}\n              >\n                Sıralamaya eklemek için üye girişi gerekli veya kayıt olmalısınız\n              </Typography>\n            )}\n          </Box>\n        </Box>\n      )}\n      {reviewMode && (\n        <Paper \n          elevation={6} \n          sx={{ \n            p: 5, \n            borderRadius: 4, \n            minWidth: 340, \n            maxWidth: 600, \n            width: '100%', \n            background: 'linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%)',\n            backdropFilter: 'blur(10px)',\n            border: '1px solid rgba(255, 255, 255, 0.2)',\n            boxShadow: '0 20px 40px rgba(0, 0, 0, 0.1)',\n            transition: 'transform 0.3s ease',\n            '&:hover': {\n              transform: 'translateY(-5px)',\n            }\n          }}\n        >\n          <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', mb: 2 }}>\n            <Typography \n              variant=\"h5\" \n              fontWeight={700} \n              align=\"center\"\n              sx={{\n                background: 'linear-gradient(135deg, #00b894 0%, #00cec9 100%)',\n                backgroundClip: 'text',\n                WebkitBackgroundClip: 'text',\n                WebkitTextFillColor: 'transparent',\n                textShadow: '0 2px 4px rgba(0, 0, 0, 0.1)',\n              }}\n            >\n              Soru {current + 1} / {questions.length} (İnceleme)\n            </Typography>\n          </Box>\n          <Typography \n            variant=\"h6\" \n            mb={3}\n            sx={{\n              color: '#2c3e50',\n              fontWeight: 600,\n              fontSize: '1.2rem',\n              lineHeight: 1.6,\n              textAlign: 'center',\n              padding: '16px',\n              background: 'rgba(255, 255, 255, 0.7)',\n              borderRadius: '12px',\n              border: '1px solid rgba(0, 184, 148, 0.2)',\n            }}\n          >\n            {q.text}\n          </Typography>\n          <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2, mb: 3 }}>\n            {options.length > 0 ? (\n              options.map((opt, idx) => {\n                const optionLetter = String.fromCharCode(65 + idx); // A, B, C, D\n                const isSelected = answers[current] === optionLetter;\n                const isCorrect = compareAnswers(optionLetter, q.correct);\n                const showColor = !!answers[current];\n                return (\n                  <Button\n                    key={idx}\n                    variant={isSelected ? 'contained' : 'outlined'}\n                    color={showColor ? (isCorrect ? 'primary' : isSelected ? 'error' : 'primary') : 'primary'}\n                    sx={{\n                      textAlign: 'left',\n                      fontWeight: 600,\n                      fontSize: 18,\n                      borderRadius: 4,\n                      py: 2,\n                      px: 2,\n                      background: !showColor \n                        ? 'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%)'\n                        : isSelected\n                          ? (isCorrect\n                              ? 'linear-gradient(135deg, #00b894 0%, #00cec9 100%)'\n                              : 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)')\n                          : (isCorrect\n                              ? 'linear-gradient(135deg, rgba(0, 184, 148, 0.1) 0%, rgba(0, 206, 201, 0.1) 100%)'\n                              : 'linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%)'),\n                      color: showColor && isSelected ? '#ffffff' : isCorrect && showColor ? '#00b894' : '#2c3e50',\n                      border: isCorrect && showColor && !isSelected\n                        ? '2px solid #00b894'\n                        : showColor && isSelected\n                          ? 'none'\n                          : '2px solid rgba(0, 184, 148, 0.3)',\n                      backdropFilter: 'blur(10px)',\n                      boxShadow: isSelected \n                        ? '0 8px 25px rgba(0, 184, 148, 0.3)' \n                        : isCorrect && showColor\n                          ? '0 4px 15px rgba(0, 184, 148, 0.2)'\n                          : '0 4px 15px rgba(0, 0, 0, 0.1)',\n                      position: 'relative',\n                      transition: 'all 0.3s ease',\n                      pointerEvents: 'none',\n                    }}\n                    disabled\n                  >\n                    <span style={{ position: 'relative', zIndex: 2 }}>{String.fromCharCode(65 + idx)}) {opt}</span>\n                    {showColor && isSelected && (\n                      <span style={{\n                        position: 'absolute',\n                        right: 16,\n                        top: '50%',\n                        transform: 'translateY(-50%)',\n                        fontWeight: 700,\n                        fontSize: 18,\n                        color: isCorrect ? '#43ea7c' : '#e74c3c',\n                        background: isCorrect ? '#eafaf3' : '#fff0f0',\n                        borderRadius: 8,\n                        padding: '2px 12px',\n                        boxShadow: '0 2px 8px rgba(67,234,124,0.08)',\n                        zIndex: 3,\n                      }}>\n                        {isCorrect ? 'Doğru' : 'Yanlış'}\n                      </span>\n                    )}\n                  </Button>\n                );\n              })\n            ) : (\n              <Typography color=\"error\" fontWeight={600} mb={2}>Bu sorunun seçenekleri eksik veya hatalı.</Typography>\n            )}\n          </Box>\n          {/* Show explanation toggle and content in review mode */}\n          {!!q.explanation && (\n            <Box sx={{ mb: 2 }}>\n              <Button variant=\"text\" onClick={() => setShowExplanation(e => !e)}>\n                {showExplanation ? 'Çözümü Gizle' : 'Çözümü Göster'}\n              </Button>\n              {showExplanation && (\n                <Typography mt={2} color=\"text.secondary\">{q.explanation}</Typography>\n              )}\n            </Box>\n          )}\n          <Box sx={{ display: 'flex', justifyContent: 'center', mt: 4 }}>\n            <Button\n              variant=\"outlined\"\n              color=\"primary\"\n              sx={{ fontWeight: 700, fontSize: 16, borderRadius: 3, px: 4, py: 1.2, boxShadow: 2, textTransform: 'none' }}\n              onClick={() => {\n                setReviewMode(false);\n                setShowSummary(true);\n                setShowExplanation(false);\n              }}\n            >\n              Sonuçlara Dön\n            </Button>\n          </Box>\n        </Paper>\n      )}\n    </Box>\n  );\n};\n\nexport default Exam;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,CAAEC,MAAM,KAAQ,OAAO,CAC1D,OAASC,SAAS,CAAEC,WAAW,CAAEC,WAAW,KAAQ,kBAAkB,CACtE,OAASC,GAAG,CAAEC,KAAK,CAAEC,UAAU,CAAEC,MAAM,CAAEC,gBAAgB,CAAEC,UAAU,KAAQ,eAAe,CAC5F,MAAO,CAAAC,aAAa,KAAM,+BAA+B,CACzD,MAAO,CAAAC,gBAAgB,KAAM,kCAAkC,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAYhE,KAAM,CAAAC,IAAc,CAAGA,CAAA,GAAM,CAC3B,KAAM,CAAEC,MAAO,CAAC,CAAGhB,SAAS,CAAC,CAAC,CAC9B,KAAM,CAAAiB,QAAQ,CAAGhB,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAiB,QAAQ,CAAGhB,WAAW,CAAC,CAAC,CAC9B,KAAM,CAACiB,SAAS,CAAEC,YAAY,CAAC,CAAGtB,QAAQ,CAAa,EAAE,CAAC,CAC1D,KAAM,CAACuB,OAAO,CAAEC,UAAU,CAAC,CAAGxB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACyB,OAAO,CAAEC,UAAU,CAAC,CAAG1B,QAAQ,CAAC,CAAC,CAAC,CACzC,KAAM,CAAC2B,QAAQ,CAAEC,WAAW,CAAC,CAAG5B,QAAQ,CAAgB,IAAI,CAAC,CAC7D,KAAM,CAAC6B,UAAU,CAAEC,aAAa,CAAC,CAAG9B,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAAC+B,eAAe,CAAEC,kBAAkB,CAAC,CAAGhC,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACiC,KAAK,CAAEC,QAAQ,CAAC,CAAGlC,QAAQ,CAAC,CAAC,CAAC,CACrC,KAAM,CAACmC,QAAQ,CAAEC,WAAW,CAAC,CAAGpC,QAAQ,CAAC,CAAC,CAAC,CAC3C,KAAM,CAACqC,WAAW,CAAEC,cAAc,CAAC,CAAGtC,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAACuC,IAAI,CAAEC,OAAO,CAAC,CAAGxC,QAAQ,CAAC,CAAC,CAAC,CACnC,KAAM,CAACyC,UAAU,CAAEC,aAAa,CAAC,CAAG1C,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAAC2C,OAAO,CAAEC,UAAU,CAAC,CAAG5C,QAAQ,CAAoB,EAAE,CAAC,CAC7D,KAAM,CAAC6C,WAAW,CAAEC,cAAc,CAAC,CAAG9C,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAAA+C,QAAQ,CAAG9C,MAAM,CAAwB,IAAI,CAAC,CACpD,KAAM,CAAC+C,KAAK,CAAEC,QAAQ,CAAC,CAAGjD,QAAQ,CAAgB,IAAI,CAAC,CAEvD;AACA,KAAM,CAAAkD,UAAU,CAAIC,IAAY,EAAK,CACnC,GAAI,CAACA,IAAI,EAAIA,IAAI,CAACC,MAAM,GAAK,CAAC,CAAE,MAAO,CAAAD,IAAI,CAC3C,MAAO,CAAAA,IAAI,CAACE,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAAGH,IAAI,CAACI,KAAK,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CACnE,CAAC,CAED;AACA,KAAM,CAAAC,cAAc,CAAGA,CAACC,OAAe,CAAEC,OAAe,GAAK,CAC3D,MAAO,CAAAD,OAAO,CAACF,WAAW,CAAC,CAAC,GAAKG,OAAO,CAACH,WAAW,CAAC,CAAC,CACxD,CAAC,CAEDzD,SAAS,CAAC,IAAM,KAAA6D,eAAA,CACd;AACA,GAAI,GAAAA,eAAA,CAACzC,QAAQ,CAAC0C,KAAK,UAAAD,eAAA,WAAdA,eAAA,CAAgBvC,SAAS,GAAIF,QAAQ,CAAC0C,KAAK,CAACxC,SAAS,CAAC+B,MAAM,GAAK,CAAC,CAAE,CACvE5B,UAAU,CAAC,IAAI,CAAC,CAChByB,QAAQ,CAAC,IAAI,CAAC,CAEd;AACA,KAAM,CAAAa,OAAO,CAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAI,uBAAuB,CACxE,GAAI,CAAAC,MAAc,CAElB,GAAIhD,MAAM,GAAK,SAAS,EAAIA,MAAM,SAANA,MAAM,WAANA,MAAM,CAAEiD,UAAU,CAAC,UAAU,CAAC,CAAE,CAC1DD,MAAM,CAAG,GAAGJ,OAAO,gBAAgB,CAEnC;AACA;AACA,KAAM,CAAAM,MAAM,CAAG,GAAI,CAAAC,eAAe,CAAC,CAAC,CACpC,GAAInD,MAAM,GAAK,YAAY,CAAE,CAC3BkD,MAAM,CAACE,GAAG,CAAC,UAAU,CAAE,IAAI,CAAC,CAC9B,CAAC,IAAM,IAAIpD,MAAM,GAAK,YAAY,EAAIA,MAAM,GAAK,SAAS,CAAE,CAC1DkD,MAAM,CAACE,GAAG,CAAC,UAAU,CAAE,IAAI,CAAC,CAC9B,CAAC,IAAM,IAAIpD,MAAM,GAAK,YAAY,CAAE,CAClCkD,MAAM,CAACE,GAAG,CAAC,UAAU,CAAE,IAAI,CAAC,CAC9B,CAAC,IAAM,IAAIpD,MAAM,GAAK,YAAY,CAAE,CAClCkD,MAAM,CAACE,GAAG,CAAC,UAAU,CAAE,IAAI,CAAC,CAC9B,CACA;AACAF,MAAM,CAACE,GAAG,CAAC,QAAQ,CAAE,gBAAgB,CAAC,CACtCJ,MAAM,EAAI,IAAIE,MAAM,CAACG,QAAQ,CAAC,CAAC,EAAE,CACnC,CAAC,IAAM,CACLL,MAAM,CAAG,GAAGJ,OAAO,cAAc5C,MAAM,YAAY,CACrD,CAEAsD,OAAO,CAACC,GAAG,CAAC,4BAA4BP,MAAM,EAAE,CAAC,CAEjDQ,KAAK,CAACR,MAAM,CAAC,CACVS,IAAI,CAACC,GAAG,EAAI,CACXJ,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAEG,GAAG,CAACC,MAAM,CAAC,CAC/C,GAAI,CAACD,GAAG,CAACE,EAAE,CAAE,CACX,KAAM,IAAI,CAAAC,KAAK,CAAC,8BAA8BH,GAAG,CAACC,MAAM,EAAE,CAAC,CAC7D,CACA,MAAO,CAAAD,GAAG,CAACI,IAAI,CAAC,CAAC,CACnB,CAAC,CAAC,CACDL,IAAI,CAACM,IAAI,EAAI,CACZT,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAEQ,IAAI,CAAC,CACvC,KAAM,CAAAC,aAAa,CAAGD,IAAI,CAAC5D,SAAS,EAAI4D,IAAI,EAAI,EAAE,CAClDT,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAES,aAAa,CAAC9B,MAAM,CAAC,CAE3D,KAAM,CAAA+B,kBAAkB,CAAGD,aAAa,CAACE,GAAG,CAAEC,CAAW,EAAK,CAC5D;AACA,GAAI,CAAAC,YAAsB,CAAG,EAAE,CAC/B,GAAIC,KAAK,CAACC,OAAO,CAACH,CAAC,CAACI,OAAO,CAAC,CAAE,CAC5BH,YAAY,CAAGD,CAAC,CAACI,OAAO,CAACL,GAAG,CAAClC,UAAU,CAAC,CAC1C,CAAC,IAAM,IAAI,MAAO,CAAAmC,CAAC,CAACI,OAAO,GAAK,QAAQ,CAAE,CACxC,GAAI,CACFH,YAAY,CAAGI,IAAI,CAACC,KAAK,CAACN,CAAC,CAACI,OAAO,CAAC,CAACL,GAAG,CAAClC,UAAU,CAAC,CACtD,CAAE,KAAM,CACNoC,YAAY,CAAG,EAAE,CACnB,CACF,CAEA;AACA,GAAI,CAAAM,aAAa,CAAGP,CAAC,CAACQ,OAAO,CAC7B,GAAIR,CAAC,CAACQ,OAAO,EAAIR,CAAC,CAACQ,OAAO,CAACzC,MAAM,CAAG,CAAC,CAAE,CACrC;AACA,KAAM,CAAA0C,YAAY,CAAGR,YAAY,CAACS,SAAS,CAACC,MAAM,EAChDA,MAAM,CAACxC,WAAW,CAAC,CAAC,GAAK6B,CAAC,CAACQ,OAAO,CAACrC,WAAW,CAAC,CACjD,CAAC,CACD,GAAIsC,YAAY,GAAK,CAAC,CAAC,CAAE,CACvBF,aAAa,CAAGK,MAAM,CAACC,YAAY,CAAC,EAAE,CAAGJ,YAAY,CAAC,CAAE;AACxDtB,OAAO,CAACC,GAAG,CAAC,cAAcY,CAAC,CAACQ,OAAO,gBAAgBD,aAAa,GAAG,CAAC,CACtE,CACF,CAEA,MAAO,CACL,GAAGP,CAAC,CACJI,OAAO,CAAEH,YAAY,CACrBO,OAAO,CAAED,aACX,CAAC,CACH,CAAC,CAAC,CACFpB,OAAO,CAACC,GAAG,CAAC,UAAUU,kBAAkB,CAAC/B,MAAM,YAAY,CAAC,CAC5D9B,YAAY,CAAC6D,kBAAkB,CAAC,CAChC3D,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAC,CACD2E,KAAK,CAACnD,KAAK,EAAI,CACdwB,OAAO,CAACxB,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CAClDC,QAAQ,CAAC,iEAAiE,CAAC,CAC3EzB,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAC,CACN,CAAC,IAAM,CACL;AACA,KAAM,CAAA2D,kBAAkB,CAAGhE,QAAQ,CAAC0C,KAAK,CAACxC,SAAS,CAAC+D,GAAG,CAAEC,CAAW,EAAK,CACvE;AACA,GAAI,CAAAC,YAAsB,CAAG,EAAE,CAC/B,GAAIC,KAAK,CAACC,OAAO,CAACH,CAAC,CAACI,OAAO,CAAC,CAAE,CAC5BH,YAAY,CAAGD,CAAC,CAACI,OAAO,CAACL,GAAG,CAAClC,UAAU,CAAC,CAC1C,CAAC,IAAM,IAAI,MAAO,CAAAmC,CAAC,CAACI,OAAO,GAAK,QAAQ,CAAE,CACxC,GAAI,CACFH,YAAY,CAAGI,IAAI,CAACC,KAAK,CAACN,CAAC,CAACI,OAAO,CAAC,CAACL,GAAG,CAAClC,UAAU,CAAC,CACtD,CAAE,KAAM,CACNoC,YAAY,CAAG,EAAE,CACnB,CACF,CAEA;AACA,GAAI,CAAAM,aAAa,CAAGP,CAAC,CAACQ,OAAO,CAC7B,GAAIR,CAAC,CAACQ,OAAO,EAAIR,CAAC,CAACQ,OAAO,CAACzC,MAAM,CAAG,CAAC,CAAE,CACrC;AACA,KAAM,CAAA0C,YAAY,CAAGR,YAAY,CAACS,SAAS,CAACC,MAAM,EAChDA,MAAM,CAACxC,WAAW,CAAC,CAAC,GAAK6B,CAAC,CAACQ,OAAO,CAACrC,WAAW,CAAC,CACjD,CAAC,CACD,GAAIsC,YAAY,GAAK,CAAC,CAAC,CAAE,CACvBF,aAAa,CAAGK,MAAM,CAACC,YAAY,CAAC,EAAE,CAAGJ,YAAY,CAAC,CAAE;AACxDtB,OAAO,CAACC,GAAG,CAAC,cAAcY,CAAC,CAACQ,OAAO,gBAAgBD,aAAa,GAAG,CAAC,CACtE,CACF,CAEA,MAAO,CACL,GAAGP,CAAC,CACJI,OAAO,CAAEH,YAAY,CACrBO,OAAO,CAAED,aACX,CAAC,CACH,CAAC,CAAC,CACFtE,YAAY,CAAC6D,kBAAkB,CAAC,CAChC3D,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAAE,CAACL,QAAQ,CAAC0C,KAAK,CAAE3C,MAAM,CAAC,CAAC,CAE5B;AACAnB,SAAS,CAAC,IAAM,CACd,GAAIsB,SAAS,CAAC+B,MAAM,CAAG,CAAC,EAAIT,OAAO,CAACS,MAAM,GAAK/B,SAAS,CAAC+B,MAAM,CAAE,CAC/DR,UAAU,CAAC2C,KAAK,CAAClE,SAAS,CAAC+B,MAAM,CAAC,CAACgD,IAAI,CAAC,IAAI,CAAC,CAAC,CAChD,CACF,CAAC,CAAE,CAAC/E,SAAS,CAAEsB,OAAO,CAACS,MAAM,CAAC,CAAC,CAE/B;AACArD,SAAS,CAAC,IAAM,CACd,GAAIsC,WAAW,EAAIQ,WAAW,CAAE,OAChCE,QAAQ,CAACtB,OAAO,CAAG4E,WAAW,CAAC,IAAM,CACnC7D,OAAO,CAAE8D,CAAC,EAAKA,CAAC,CAAG,CAAC,CAAC,CACvB,CAAC,CAAE,IAAI,CAAC,CACR,MAAO,IAAM,CACX,GAAIvD,QAAQ,CAACtB,OAAO,CAAE8E,aAAa,CAACxD,QAAQ,CAACtB,OAAO,CAAC,CACvD,CAAC,CACH,CAAC,CAAE,CAACY,WAAW,CAAEQ,WAAW,CAAC,CAAC,CAE9B,GAAItB,OAAO,CAAE,CACX,mBACET,IAAA,CAACT,GAAG,EAACmG,EAAE,CAAE,CAAEC,SAAS,CAAE,OAAO,CAAEC,OAAO,CAAE,SAAS,CAAEC,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEC,cAAc,CAAE,QAAS,CAAE,CAAAC,QAAA,cACnH9F,KAAA,CAACX,GAAG,EAACmG,EAAE,CAAE,CACPO,CAAC,CAAE,CAAC,CACJC,YAAY,CAAE,CAAC,CACfC,UAAU,CAAE,mDAAmD,CAC/DC,SAAS,CAAE,6BAA6B,CACxCC,SAAS,CAAE,QACb,CAAE,CAAAL,QAAA,eACAhG,IAAA,CAACL,gBAAgB,EAAC+F,EAAE,CAAE,CAAEY,KAAK,CAAE,SAAS,CAAEC,EAAE,CAAE,CAAE,CAAE,CAAE,CAAC,cACrDvG,IAAA,CAACP,UAAU,EAAC+G,OAAO,CAAC,IAAI,CAACd,EAAE,CAAE,CAAEY,KAAK,CAAE,SAAS,CAAEG,UAAU,CAAE,GAAI,CAAE,CAAAT,QAAA,CAAC,0BAEpE,CAAY,CAAC,EACV,CAAC,CACH,CAAC,CAEV,CAEA,GAAI9D,KAAK,CAAE,CACT,mBACElC,IAAA,CAACT,GAAG,EAACmG,EAAE,CAAE,CAAEC,SAAS,CAAE,OAAO,CAAEC,OAAO,CAAE,SAAS,CAAEC,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEC,cAAc,CAAE,QAAS,CAAE,CAAAC,QAAA,cACnH9F,KAAA,CAACX,GAAG,EAACmG,EAAE,CAAE,CAAEO,CAAC,CAAE,CAAC,CAAEC,YAAY,CAAE,CAAC,CAAEC,UAAU,CAAE,mDAAmD,CAAEC,SAAS,CAAE,6BAA6B,CAAEC,SAAS,CAAE,QAAS,CAAE,CAAAL,QAAA,eACjKhG,IAAA,CAACP,UAAU,EAAC+G,OAAO,CAAC,IAAI,CAACd,EAAE,CAAE,CAAEY,KAAK,CAAE,SAAS,CAAEG,UAAU,CAAE,GAAG,CAAEF,EAAE,CAAE,CAAE,CAAE,CAAAP,QAAA,CAAE9D,KAAK,CAAa,CAAC,cAC/FlC,IAAA,CAACN,MAAM,EAAC8G,OAAO,CAAC,WAAW,CAACE,OAAO,CAAEA,CAAA,GAAMC,MAAM,CAACtG,QAAQ,CAACuG,MAAM,CAAC,CAAE,CAAAZ,QAAA,CAAC,aAAW,CAAQ,CAAC,EACtF,CAAC,CACH,CAAC,CAEV,CAEA,GAAI,CAACzF,SAAS,CAAC+B,MAAM,CAAE,CACrB,mBAAOtC,IAAA,CAACP,UAAU,EAACoH,KAAK,CAAC,QAAQ,CAACC,EAAE,CAAE,CAAE,CAAAd,QAAA,CAAC,6CAA8B,CAAY,CAAC,CACtF,CAEA,KAAM,CAAAzB,CAAC,CAAGhE,SAAS,CAACI,OAAO,CAAC,CAC5B;AACA,GAAI,CAAAgE,OAAiB,CAAG,EAAE,CAC1B,GAAIF,KAAK,CAACC,OAAO,CAACH,CAAC,CAACI,OAAO,CAAC,CAAE,CAC5BA,OAAO,CAAGJ,CAAC,CAACI,OAAO,CACrB,CAAC,IAAM,IAAI,MAAO,CAAAJ,CAAC,CAACI,OAAO,GAAK,QAAQ,CAAE,CACxC,GAAI,CACFA,OAAO,CAAGC,IAAI,CAACC,KAAK,CAACN,CAAC,CAACI,OAAO,CAAC,CACjC,CAAE,KAAM,CACNA,OAAO,CAAG,EAAE,CACd,CACF,CAEA;AACA,KAAM,CAAAoC,oBAAoB,CAAGA,CAAA,GAAM,CACjC,GAAI,CAACxC,CAAC,CAACQ,OAAO,EAAIJ,OAAO,CAACrC,MAAM,GAAK,CAAC,CAAE,MAAO,CAAAiC,CAAC,CAACQ,OAAO,CACxD,KAAM,CAAAC,YAAY,CAAGT,CAAC,CAACQ,OAAO,CAACiC,UAAU,CAAC,CAAC,CAAC,CAAG,EAAE,CAAE;AACnD,KAAM,CAAAC,WAAW,CAAGtC,OAAO,CAACK,YAAY,CAAC,CACzC,MAAO,CAAAiC,WAAW,CAAG,GAAG1C,CAAC,CAACQ,OAAO,KAAKkC,WAAW,EAAE,CAAG1C,CAAC,CAACQ,OAAO,CACjE,CAAC,CAED,KAAM,CAAAmC,YAAY,CAAIC,WAAmB,EAAK,CAC5C,KAAM,CAAAC,cAAc,CAAGjC,MAAM,CAACC,YAAY,CAAC,EAAE,CAAG+B,WAAW,CAAC,CAAE;AAC9DzD,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAEwD,WAAW,CAAC,CAClDzD,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAEyD,cAAc,CAAC,CAC/C1D,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAEY,CAAC,CAACQ,OAAO,CAAC,CAClDrB,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAE,MAAO,CAAAY,CAAC,CAACQ,OAAO,CAAC,CAE9DjE,WAAW,CAACsG,cAAc,CAAC,CAC3BpG,aAAa,CAAC,IAAI,CAAC,CACnBgB,cAAc,CAAC,IAAI,CAAC,CAAE;AACtBF,UAAU,CAAEuF,IAAI,EAAK,CACnB,KAAM,CAAAC,IAAI,CAAG,CAAC,GAAGD,IAAI,CAAC,CACtBC,IAAI,CAAC3G,OAAO,CAAC,CAAGyG,cAAc,CAC9B,MAAO,CAAAE,IAAI,CACb,CAAC,CAAC,CACF,GAAI3E,cAAc,CAACyE,cAAc,CAAE7C,CAAC,CAACQ,OAAO,CAAC,CAAE,CAC7C3D,QAAQ,CAAEmG,CAAC,EAAKA,CAAC,CAAG,CAAC,CAAC,CACxB,CAAC,IAAM,CACLjG,WAAW,CAAEkG,CAAC,EAAKA,CAAC,CAAG,CAAC,CAAC,CAC3B,CACF,CAAC,CAED,KAAM,CAAAC,YAAY,CAAGA,CAAA,GAAM,CACzB,GAAI9G,OAAO,CAAGJ,SAAS,CAAC+B,MAAM,CAAG,CAAC,CAAE,CAClC1B,UAAU,CAAC8G,CAAC,EAAIA,CAAC,CAAG,CAAC,CAAC,CACtB5G,WAAW,CAACe,OAAO,CAAClB,OAAO,CAAG,CAAC,CAAC,EAAI,IAAI,CAAC,CACzCK,aAAa,CAAC,CAAC,CAACa,OAAO,CAAClB,OAAO,CAAG,CAAC,CAAC,CAAC,CACrCO,kBAAkB,CAAC,KAAK,CAAC,CACzBc,cAAc,CAAC,KAAK,CAAC,CAAE;AACzB,CACF,CAAC,CAED;AACA,KAAM,CAAA2F,aAAa,CAAG,KAAO,CAAAC,OAAmG,EAAK,CACrI,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C;AACA,GAAI,CAACF,KAAK,CAAE,OACV,GAAI,KAAAG,WAAA,CAAAC,YAAA,CAAAC,YAAA,CAAAC,YAAA,CACF,KAAM,CAAArE,GAAG,CAAG,KAAM,CAAAF,KAAK,CAAC,mCAAmC,CAAE,CAC3DwE,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,IAAIR,KAAK,CAAG,CAAE,eAAe,CAAE,UAAUA,KAAK,EAAG,CAAC,CAAG,CAAC,CAAC,CACzD,CAAC,CACDS,IAAI,CAAE1D,IAAI,CAAC2D,SAAS,CAAC,CACnBC,QAAQ,CAAE,QAAAR,WAAA,CAAOzH,SAAS,CAAC,CAAC,CAAC,UAAAyH,WAAA,iBAAZA,WAAA,CAAcS,UAAU,IAAK,QAAQ,EAAAR,YAAA,CAAG1H,SAAS,CAAC,CAAC,CAAC,UAAA0H,YAAA,iBAAZA,YAAA,CAAcQ,UAAU,CAAGtD,MAAM,EAAA+C,YAAA,CAAC3H,SAAS,CAAC,CAAC,CAAC,UAAA2H,YAAA,iBAAZA,YAAA,CAAcO,UAAU,CAAC,CACpHC,QAAQ,CAAE,EAAAP,YAAA,CAAA5H,SAAS,CAAC,CAAC,CAAC,UAAA4H,YAAA,iBAAZA,YAAA,CAAcO,QAAQ,GAAI,IAAI,CACxCC,QAAQ,CAAEf,OAAO,CAAGA,OAAO,CAACe,QAAQ,CAAGlH,IAAI,CAC3CsD,OAAO,CAAE6C,OAAO,CAAGA,OAAO,CAAC7C,OAAO,CAAG5D,KAAK,CAC1CyH,SAAS,CAAEhB,OAAO,CAAGA,OAAO,CAACgB,SAAS,CAAGvH,QAAQ,CACjDd,SAAS,CAAEA,SAAS,CAAC+D,GAAG,CAAC,CAACC,CAAC,CAAEsE,GAAG,IAAM,CACpCC,UAAU,CAAEvE,CAAC,CAACwE,EAAE,CAChBC,UAAU,CAAGpB,OAAO,CAAGA,OAAO,CAACqB,YAAY,CAACJ,GAAG,CAAC,CAAGhH,OAAO,CAACgH,GAAG,CAAE,CAChEK,SAAS,CAAE,CAAC,IAAM,CAChB,KAAM,CAAAC,EAAE,CAAGvB,OAAO,CAAGA,OAAO,CAACqB,YAAY,CAACJ,GAAG,CAAC,CAAGhH,OAAO,CAACgH,GAAG,CAAC,CAC7D,MAAO,CAAAM,EAAE,CAAGxG,cAAc,CAACwG,EAAE,CAAG5E,CAAC,CAACQ,OAAO,CAAC,CAAG,KAAK,CACpD,CAAC,EAAE,CACL,CAAC,CAAC,CACJ,CAAC,CACH,CAAC,CAAC,CACF,GAAI,CAACjB,GAAG,CAACE,EAAE,CAAE,CACX,GAAI,CACF,KAAM,CAAAG,IAAI,CAAG,KAAM,CAAAL,GAAG,CAACI,IAAI,CAAC,CAAC,CAC7B;AACAR,OAAO,CAACxB,KAAK,CAAC,qBAAqB,CAAEiC,IAAI,CAAC,CAC5C,CAAE,MAAOiF,CAAC,CAAE,CACV;AACA1F,OAAO,CAACxB,KAAK,CAAC,+BAA+B,CAAE4B,GAAG,CAACC,MAAM,CAAED,GAAG,CAACuF,UAAU,CAAC,CAC5E,CACA;AACF,CACF,CAAE,MAAOD,CAAC,CAAE,CACV;AACJ1F,OAAO,CAACxB,KAAK,CAAC,6BAA6B,CAAEkH,CAAC,CAAC,CAC/C;AACE,CACF,CAAC,CAED,KAAM,CAAAE,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B;AACA,KAAM,CAAAC,gBAAgB,CAAG9E,KAAK,CAAC+E,IAAI,CAAC,CAAElH,MAAM,CAAE/B,SAAS,CAAC+B,MAAO,CAAC,CAAE,CAACmH,CAAC,CAAEC,CAAC,GAAM7H,OAAO,CAAC6H,CAAC,CAAC,GAAKC,SAAS,CAAG9H,OAAO,CAAC6H,CAAC,CAAC,CAAG,IAAK,CAAC,CAC3H,GAAI7H,OAAO,CAACS,MAAM,GAAK,CAAC,EAAIT,OAAO,CAACS,MAAM,GAAK/B,SAAS,CAAC+B,MAAM,CAAE,CAC/DR,UAAU,CAACyH,gBAAgB,CAAC,CAC9B,CAEA;AACA,GAAI,CAAAK,YAAY,CAAG,CAAC,CACpB,GAAI,CAAAC,cAAc,CAAG,CAAC,CACtB,GAAI,CAAAC,eAAe,CAAG,CAAC,CAEvBvJ,SAAS,CAACwJ,OAAO,CAAC,CAACC,QAAQ,CAAEnB,GAAG,GAAK,CACnC,KAAM,CAAAG,UAAU,CAAGO,gBAAgB,CAACV,GAAG,CAAC,CACxC,GAAIG,UAAU,GAAK,IAAI,EAAIA,UAAU,GAAKW,SAAS,EAAIX,UAAU,GAAK,EAAE,CAAE,CACxEc,eAAe,EAAE,CACnB,CAAC,IAAM,IAAInH,cAAc,CAACqG,UAAU,CAAEgB,QAAQ,CAACjF,OAAO,CAAC,CAAE,CACvD6E,YAAY,EAAE,CAChB,CAAC,IAAM,CACLC,cAAc,EAAE,CAClB,CACF,CAAC,CAAC,CAEF;AACAzI,QAAQ,CAACwI,YAAY,CAAC,CACtBtI,WAAW,CAACuI,cAAc,CAAC,CAE3BrI,cAAc,CAAC,IAAI,CAAC,CACpBI,aAAa,CAAC,KAAK,CAAC,CACpBI,cAAc,CAAC,IAAI,CAAC,CAAE;AACtB,GAAIC,QAAQ,CAACtB,OAAO,CAAE8E,aAAa,CAACxD,QAAQ,CAACtB,OAAO,CAAC,CAErD,KAAM,CAAAgH,aAAa,CAAC,CAClB5C,OAAO,CAAE6E,YAAY,CACrBhB,SAAS,CAAEiB,cAAc,CACzBlB,QAAQ,CAAElH,IAAI,CACdwH,YAAY,CAAEM,gBAChB,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAU,kBAAkB,CAAGA,CAAA,GAAM,CAC/BzI,cAAc,CAAC,KAAK,CAAC,CACrBI,aAAa,CAAC,KAAK,CAAC,CACpBhB,UAAU,CAAC,CAAC,CAAC,CACbE,WAAW,CAAC,IAAI,CAAC,CACjBE,aAAa,CAAC,KAAK,CAAC,CACpBE,kBAAkB,CAAC,KAAK,CAAC,CACzBE,QAAQ,CAAC,CAAC,CAAC,CACXE,WAAW,CAAC,CAAC,CAAC,CACdI,OAAO,CAAC,CAAC,CAAC,CACVI,UAAU,CAAC,EAAE,CAAC,CAChB,CAAC,CAED,KAAM,CAAAoI,gBAAgB,CAAGA,CAAA,GAAM,CAC7B;AACA,KAAM,CAAArC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAI,CAACF,KAAK,CAAE,CACV;AACAvH,QAAQ,CAAC,QAAQ,CAAC,CAClB,OACF,CAEA;AACA,GAAI,CAAA6J,SAAgD,CACpD,GAAI/J,MAAM,GAAK,YAAY,CAAE+J,SAAS,CAAG,IAAI,CAAC,IACzC,IAAI/J,MAAM,GAAK,YAAY,EAAIA,MAAM,GAAK,SAAS,CAAE+J,SAAS,CAAG,IAAI,CAAC,IACtE,IAAI/J,MAAM,GAAK,YAAY,CAAE+J,SAAS,CAAG,IAAI,CAAC,IAC9C,IAAI/J,MAAM,GAAK,YAAY,CAAE+J,SAAS,CAAG,IAAI,CAElD;AACA,KAAM,CAAA1B,UAAU,CAAGlE,CAAC,CAACkE,UAAU,CAC/B,KAAM,CAAAC,QAAQ,CAAGnE,CAAC,CAACmE,QAAQ,CAC3B9E,KAAK,CAAC,oCAAoC,CAAE,CAC1CwE,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CAAE,cAAc,CAAE,kBAAkB,CAAE+B,aAAa,CAAE,UAAUvC,KAAK,EAAG,CAAC,CACjFS,IAAI,CAAE1D,IAAI,CAAC2D,SAAS,CAAC,CAAEpH,KAAK,CAAEM,IAAI,CAAEgH,UAAU,CAAEC,QAAQ,CAAE3D,OAAO,CAAE5D,KAAK,CAAEE,QAAS,CAAC,CACtF,CAAC,CAAC,CACCwC,IAAI,CAAC,KAAM,CAAAC,GAAG,EAAI,CACjB,GAAI,CAAAK,IAAI,CACR,GAAI,CACFA,IAAI,CAAG,KAAM,CAAAL,GAAG,CAACI,IAAI,CAAC,CAAC,CACzB,CAAE,MAAOkF,CAAC,CAAE,CACVjF,IAAI,CAAG,CAAC,CAAC,CACX,CACA,GAAI,CAACL,GAAG,CAACE,EAAE,CAAE,KAAAqG,KAAA,CAAAC,MAAA,CAAAC,MAAA,CACX7G,OAAO,CAACxB,KAAK,CAAC,qBAAqB,CAAEiC,IAAI,CAAC,CAC1C,GAAI,CAAAqG,YAAY,CAAG,yBAAyB,EAAI,EAAAH,KAAA,CAAAlG,IAAI,UAAAkG,KAAA,iBAAJA,KAAA,CAAMI,OAAO,GAAI3G,GAAG,CAACuF,UAAU,CAAC,CAEhF;AACA,GAAI,EAAAiB,MAAA,CAAAnG,IAAI,UAAAmG,MAAA,iBAAJA,MAAA,CAAMG,OAAO,IAAK,8BAA8B,EAAI3G,GAAG,CAACC,MAAM,GAAK,GAAG,CAAE,CAC1EyG,YAAY,CAAG,6CAA6C,CAC9D,CACA;AACA,GAAI,QAAAD,MAAA,CAAOpG,IAAI,UAAAoG,MAAA,iBAAJA,MAAA,CAAMrI,KAAK,IAAK,QAAQ,EAAIiC,IAAI,CAACjC,KAAK,CAACwI,QAAQ,CAAC,gCAAgC,CAAC,CAAE,CAC5FF,YAAY,CAAG,qFAAqF,CACtG,CAEAG,KAAK,CAACH,YAAY,CAAC,CACnB,OACF,CACAhJ,cAAc,CAAC,KAAK,CAAC,CACrB;AACAlB,QAAQ,CAAC6J,SAAS,CAAG,kBAAkBA,SAAS,EAAE,CAAG,WAAW,CAAC,CACnE,CAAC,CAAC,CACD9E,KAAK,CAACuF,GAAG,EAAI,CACZlH,OAAO,CAACxB,KAAK,CAAC,qBAAqB,CAAE0I,GAAG,CAAC,CACzCD,KAAK,CAAC,wCAAwC,CAAC,CACjD,CAAC,CAAC,CACN,CAAC,CAED,KAAM,CAAAE,YAAY,CAAGA,CAAA,GAAM,CACzB,GAAIlK,OAAO,CAAG,CAAC,CAAE,CACfC,UAAU,CAAC8G,CAAC,EAAIA,CAAC,CAAG,CAAC,CAAC,CACtB5G,WAAW,CAACe,OAAO,CAAClB,OAAO,CAAG,CAAC,CAAC,EAAI,IAAI,CAAC,CACzCK,aAAa,CAAC,CAAC,CAACa,OAAO,CAAClB,OAAO,CAAG,CAAC,CAAC,CAAC,CACrCO,kBAAkB,CAAC,KAAK,CAAC,CACzB;AACAc,cAAc,CAAC,CAAC,CAACH,OAAO,CAAClB,OAAO,CAAG,CAAC,CAAC,CAAC,CACxC,CACF,CAAC,CAED,mBACET,KAAA,CAACX,GAAG,EAACmG,EAAE,CAAE,CAAEC,SAAS,CAAE,OAAO,CAAEC,OAAO,CAAE,SAAS,CAAEC,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEC,cAAc,CAAE,QAAQ,CAAE+E,QAAQ,CAAE,UAAW,CAAE,CAAA9E,QAAA,eAE3I9F,KAAA,CAACX,GAAG,EACAmG,EAAE,CAAE,CACFG,OAAO,CAAE,CAAEkF,EAAE,CAAE,MAAM,CAAEC,EAAE,CAAE,MAAO,CAAC,CACnCF,QAAQ,CAAE,OAAO,CACrBG,GAAG,CAAE,CAAED,EAAE,CAAE,EAAE,CAAEE,EAAE,CAAE,EAAG,CAAC,CACnBC,KAAK,CAAE,CAAEH,EAAE,CAAE,EAAE,CAAEE,EAAE,CAAE,EAAG,CAAC,CACzBE,MAAM,CAAE,IAAI,CACZjF,UAAU,CAAEpE,WAAW,CACnB,mDAAmD,CACnD,mDAAmD,CACvDuE,KAAK,CAAE,MAAM,CACb+E,EAAE,CAAE,CAAEL,EAAE,CAAE,CAAC,CAAEE,EAAE,CAAE,GAAI,CAAC,CACtBI,EAAE,CAAE,CAAEN,EAAE,CAAE,IAAI,CAAEE,EAAE,CAAE,CAAE,CAAC,CACvBhF,YAAY,CAAE,CAAC,CACfO,UAAU,CAAE,GAAG,CACf8E,QAAQ,CAAE,CAAEP,EAAE,CAAE,EAAE,CAAEE,EAAE,CAAE,EAAG,CAAC,CAC5B9E,SAAS,CAAE,8BAA8B,CACzCN,UAAU,CAAE,QAAQ,CACpB0F,cAAc,CAAE,WAAW,CAC3BC,MAAM,CAAE,kCAAkC,CAC1CC,GAAG,CAAE,CACP,CAAE,CACF,aAAW,oBAAoB,CAAA1F,QAAA,EAE9BjE,WAAW,eAAI/B,IAAA,SAAAgG,QAAA,CAAM,cAAE,CAAM,CAAC,CAC9B2F,IAAI,CAACC,KAAK,CAACnK,IAAI,CAAG,EAAE,CAAC,CAAC,GAAC,CAAC,CAACA,IAAI,CAAG,EAAE,EAAEgC,QAAQ,CAAC,CAAC,CAACoI,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,EAC7D,CAAC,cAGN7L,IAAA,CAACJ,UAAU,EACT8F,EAAE,CAAE,CACFG,OAAO,CAAE,CAAEkF,EAAE,CAAE,MAAM,CAAEC,EAAE,CAAE,aAAc,CAAC,CAC1CF,QAAQ,CAAE,UAAU,CACpBgB,IAAI,CAAE,CAAEf,EAAE,CAAE,CAAC,CAAEC,EAAE,CAAE,EAAG,CAAC,CACvBC,GAAG,CAAE,KAAK,CACVc,SAAS,CAAE,kBAAkB,CAC7BX,MAAM,CAAE,CAAC,CACTjF,UAAU,CAAExF,OAAO,CAAG,CAAC,CACnB,+EAA+E,CAC/E,uBAAuB,CAC3B2F,KAAK,CAAE3F,OAAO,CAAG,CAAC,CAAG,SAAS,CAAG,SAAS,CAC1C6K,cAAc,CAAE,YAAY,CAC5BC,MAAM,CAAE,oCAAoC,CAC5CrF,SAAS,CAAEzF,OAAO,CAAG,CAAC,CAAG,mCAAmC,CAAG,+BAA+B,CAC9FuF,YAAY,CAAE,CAAC,CACfD,CAAC,CAAE,CAAC,CACJ+F,MAAM,CAAErL,OAAO,CAAG,CAAC,CAAG,SAAS,CAAG,SAAS,CAC3CsL,OAAO,CAAEtL,OAAO,CAAG,CAAC,CAAG,CAAC,CAAG,GAAG,CAC9BuL,UAAU,CAAE,eAAe,CAC3B,SAAS,CAAE,CACTH,SAAS,CAAEpL,OAAO,CAAG,CAAC,CAAG,mCAAmC,CAAG,kBAAkB,CACjFwF,UAAU,CAAExF,OAAO,CAAG,CAAC,CACnB,iFAAiF,CACjF,uBAAuB,CAC3ByF,SAAS,CAAEzF,OAAO,CAAG,CAAC,CAAG,oCAAoC,CAAG,+BAClE,CACF,CAAE,CACF+F,OAAO,CAAEmE,YAAa,CACtBsB,QAAQ,CAAExL,OAAO,GAAK,CAAE,CAAAqF,QAAA,cAExBhG,IAAA,CAACH,aAAa,EAAC0L,QAAQ,CAAC,OAAO,CAAE,CAAC,CACxB,CAAC,cACbvL,IAAA,CAACJ,UAAU,EACT8F,EAAE,CAAE,CACFG,OAAO,CAAE,CAAEkF,EAAE,CAAE,MAAM,CAAEC,EAAE,CAAE,aAAc,CAAC,CAC1CF,QAAQ,CAAE,UAAU,CACpBK,KAAK,CAAE,CAAEJ,EAAE,CAAE,CAAC,CAAEC,EAAE,CAAE,EAAG,CAAC,CACxBC,GAAG,CAAE,KAAK,CACVc,SAAS,CAAE,kBAAkB,CAC7BX,MAAM,CAAE,CAAC,CACTjF,UAAU,CAAExF,OAAO,CAAGJ,SAAS,CAAC+B,MAAM,CAAG,CAAC,CACtC,+EAA+E,CAC/E,uBAAuB,CAC3BgE,KAAK,CAAE3F,OAAO,CAAGJ,SAAS,CAAC+B,MAAM,CAAG,CAAC,CAAG,SAAS,CAAG,SAAS,CAC7DkJ,cAAc,CAAE,YAAY,CAC5BC,MAAM,CAAE,oCAAoC,CAC5CrF,SAAS,CAAEzF,OAAO,CAAGJ,SAAS,CAAC+B,MAAM,CAAG,CAAC,CAAG,mCAAmC,CAAG,+BAA+B,CACjH4D,YAAY,CAAE,CAAC,CACfD,CAAC,CAAE,CAAC,CACJ+F,MAAM,CAAErL,OAAO,CAAGJ,SAAS,CAAC+B,MAAM,CAAG,CAAC,CAAG,SAAS,CAAG,SAAS,CAC9D2J,OAAO,CAAEtL,OAAO,CAAGJ,SAAS,CAAC+B,MAAM,CAAG,CAAC,CAAG,CAAC,CAAG,GAAG,CACjD4J,UAAU,CAAE,eAAe,CAC3B,SAAS,CAAE,CACTH,SAAS,CAAEpL,OAAO,CAAGJ,SAAS,CAAC+B,MAAM,CAAG,CAAC,CAAG,kCAAkC,CAAG,kBAAkB,CACnG6D,UAAU,CAAExF,OAAO,CAAGJ,SAAS,CAAC+B,MAAM,CAAG,CAAC,CACtC,iFAAiF,CACjF,uBAAuB,CAC3B8D,SAAS,CAAEzF,OAAO,CAAGJ,SAAS,CAAC+B,MAAM,CAAG,CAAC,CAAG,oCAAoC,CAAG,+BACrF,CACF,CAAE,CACFoE,OAAO,CAAEe,YAAa,CACtB0E,QAAQ,CAAExL,OAAO,GAAKJ,SAAS,CAAC+B,MAAM,CAAG,CAAE,CAAA0D,QAAA,cAE3ChG,IAAA,CAACF,gBAAgB,EAACyL,QAAQ,CAAC,OAAO,CAAE,CAAC,CAC3B,CAAC,CACZ,CAAC5J,UAAU,eACVzB,KAAA,CAACV,KAAK,EACJ4M,SAAS,CAAE,CAAE,CACb1G,EAAE,CAAE,CACFO,CAAC,CAAE,CAAE8E,EAAE,CAAE,CAAC,CAAEsB,EAAE,CAAE,CAAC,CAAErB,EAAE,CAAE,CAAE,CAAC,CAC1BF,QAAQ,CAAE,UAAU,CACpB5E,YAAY,CAAE,CAAC,CACfoG,KAAK,CAAE,MAAM,CACbC,QAAQ,CAAE,CAAExB,EAAE,CAAE,GAAG,CAAEsB,EAAE,CAAE,GAAG,CAAErB,EAAE,CAAE,GAAI,CAAC,CACvC7E,UAAU,CAAE,gFAAgF,CAC5FqF,cAAc,CAAE,YAAY,CAC5BC,MAAM,CAAE,oCAAoC,CAC5CrF,SAAS,CAAE,gCAAgC,CAC3C8F,UAAU,CAAE,qBAAqB,CACjC,SAAS,CAAE,CACTH,SAAS,CAAE,kBACb,CACF,CAAE,CAAA/F,QAAA,eAGF9F,KAAA,CAACX,GAAG,EACFmG,EAAE,CAAE,CACFoF,QAAQ,CAAE,UAAU,CACpBG,GAAG,CAAE,EAAE,CACPE,KAAK,CAAE,CAAEJ,EAAE,CAAE,EAAE,CAAEC,EAAE,CAAE,EAAG,CAAC,CACzBI,MAAM,CAAE,CAAC,CACfvF,OAAO,CAAE,CAAEkF,EAAE,CAAE,MAAM,CAAEC,EAAE,CAAE,MAAO,CAAC,CAC7B7E,UAAU,CAAEpE,WAAW,CACnB,mDAAmD,CACnD,mDAAmD,CACvDuE,KAAK,CAAE,MAAM,CACb+E,EAAE,CAAE,CAAEN,EAAE,CAAE,IAAI,CAAEC,EAAE,CAAE,CAAE,CAAC,CACvBM,EAAE,CAAE,CAAEP,EAAE,CAAE,GAAG,CAAEC,EAAE,CAAE,CAAE,CAAC,CACtB9E,YAAY,CAAE,CAAE6E,EAAE,CAAE,CAAC,CAAEC,EAAE,CAAE,CAAE,CAAC,CAC9BvE,UAAU,CAAE,GAAG,CACf8E,QAAQ,CAAE,CAAER,EAAE,CAAE,EAAE,CAAEC,EAAE,CAAE,EAAG,CAAC,CAC5B5E,SAAS,CAAE,mCAAmC,CAC9CN,UAAU,CAAE,QAAQ,CACpB0F,cAAc,CAAE,YAAY,CAC5BC,MAAM,CAAE,oCAAoC,CAC5CC,GAAG,CAAE,CAAEX,EAAE,CAAE,GAAG,CAAEC,EAAE,CAAE,CAAE,CAAC,CACvBkB,UAAU,CAAE,4BACd,CAAE,CAAAlG,QAAA,EAEDjE,WAAW,eAAI/B,IAAA,SAAAgG,QAAA,CAAM,cAAE,CAAM,CAAC,CAC9B2F,IAAI,CAACC,KAAK,CAACnK,IAAI,CAAG,EAAE,CAAC,CAAC,GAAC,CAAC,CAACA,IAAI,CAAG,EAAE,EAAEgC,QAAQ,CAAC,CAAC,CAACoI,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,EAC7D,CAAC,cACN7L,IAAA,CAACT,GAAG,EAACmG,EAAE,CAAE,CAAEG,OAAO,CAAE,MAAM,CAAEE,cAAc,CAAE,QAAQ,CAAED,UAAU,CAAE,QAAQ,CAAES,EAAE,CAAE,CAAE,CAAE,CAAAP,QAAA,cAClF9F,KAAA,CAACT,UAAU,EACT+G,OAAO,CAAC,IAAI,CACZC,UAAU,CAAE,GAAI,CAChBI,KAAK,CAAC,QAAQ,CACdnB,EAAE,CAAE,CACFS,UAAU,CAAE,mDAAmD,CAC/DqG,cAAc,CAAE,MAAM,CACtBC,oBAAoB,CAAE,MAAM,CAC5BC,mBAAmB,CAAE,aAAa,CAClCC,UAAU,CAAE,8BACd,CAAE,CAAA3G,QAAA,EACH,OACM,CAACrF,OAAO,CAAG,CAAC,CAAC,KAAG,CAACJ,SAAS,CAAC+B,MAAM,EAC5B,CAAC,CACV,CAAC,cACNtC,IAAA,CAACP,UAAU,EACT+G,OAAO,CAAC,IAAI,CACZD,EAAE,CAAE,CAAE,CACNb,EAAE,CAAE,CACFY,KAAK,CAAE,SAAS,CAChBG,UAAU,CAAE,GAAG,CACf8E,QAAQ,CAAE,CAAER,EAAE,CAAE,MAAM,CAAEsB,EAAE,CAAE,QAAQ,CAAErB,EAAE,CAAE,QAAS,CAAC,CACpD4B,UAAU,CAAE,GAAG,CACfvG,SAAS,CAAE,QAAQ,CACnBJ,CAAC,CAAE,CAAE8E,EAAE,CAAE,IAAI,CAAEsB,EAAE,CAAE,GAAG,CAAErB,EAAE,CAAE,CAAE,CAAC,CAC/B7E,UAAU,CAAE,0BAA0B,CACtCD,YAAY,CAAE,MAAM,CACpBuF,MAAM,CAAE,kCACV,CAAE,CAAAzF,QAAA,CAEDzB,CAAC,CAAClC,IAAI,CACG,CAAC,cACbrC,IAAA,CAACT,GAAG,EAACmG,EAAE,CAAE,CAAEG,OAAO,CAAE,MAAM,CAAEgH,aAAa,CAAE,QAAQ,CAAEnB,GAAG,CAAE,CAAC,CAAEnF,EAAE,CAAE,CAAE,CAAE,CAAAP,QAAA,CAClErB,OAAO,CAACrC,MAAM,CAAG,CAAC,CACjBqC,OAAO,CAACL,GAAG,CAAC,CAACwI,GAAG,CAAEjE,GAAG,GAAK,CACxB,KAAM,CAAAkE,YAAY,CAAG5H,MAAM,CAACC,YAAY,CAAC,EAAE,CAAGyD,GAAG,CAAC,CAAE;AACpD,KAAM,CAAAmE,UAAU,CAAGnM,QAAQ,GAAKkM,YAAY,CAC5C,KAAM,CAAA7D,SAAS,CAAGvG,cAAc,CAACoK,YAAY,CAAExI,CAAC,CAACQ,OAAO,CAAC,CACzD,KAAM,CAAAkI,SAAS,CAAG,CAAC,CAACpM,QAAQ,CAC5B,mBACNX,KAAA,CAACR,MAAM,EAEG8G,OAAO,CAAEwG,UAAU,CAAG,WAAW,CAAG,UAAW,CAC/C1G,KAAK,CAAE2G,SAAS,CAAI/D,SAAS,CAAG,SAAS,CAAG8D,UAAU,CAAG,OAAO,CAAG,SAAS,CAAI,SAAU,CAC1FtH,EAAE,CAAE,CACFW,SAAS,CAAE,MAAM,CACjBI,UAAU,CAAE,GAAG,CACzB8E,QAAQ,CAAE,CAAER,EAAE,CAAE,EAAE,CAAEsB,EAAE,CAAE,EAAE,CAAErB,EAAE,CAAE,EAAG,CAAC,CAC1BkC,aAAa,CAAE,MAAM,CACrBhH,YAAY,CAAE,CAAC,CACzBoF,EAAE,CAAE,CAAEP,EAAE,CAAE,IAAI,CAAEsB,EAAE,CAAE,GAAG,CAAErB,EAAE,CAAE,CAAE,CAAC,CAChCK,EAAE,CAAE,CAAEN,EAAE,CAAE,GAAG,CAAEsB,EAAE,CAAE,CAAE,CAAC,CACZlG,UAAU,CAAE,CAAC8G,SAAS,CAClB,+EAA+E,CAC/ED,UAAU,CACP9D,SAAS,CACN,mDAAmD,CACnD,mDAAmD,CACvD,+EAA+E,CACrF5C,KAAK,CAAE2G,SAAS,EAAID,UAAU,CAAG,SAAS,CAAG,SAAS,CACtDvB,MAAM,CAAEwB,SAAS,EAAID,UAAU,CAC3B,MAAM,CACN,kCAAkC,CACtCxB,cAAc,CAAE,YAAY,CAC5BpF,SAAS,CAAE4G,UAAU,CACjB,mCAAmC,CACnC,+BAA+B,CACnClC,QAAQ,CAAE,UAAU,CACpBoB,UAAU,CAAE,eAAe,CAC3B,SAAS,CAAE,CACTH,SAAS,CAAE,CAAClL,QAAQ,CAAG,kBAAkB,CAAG,MAAM,CAClDsF,UAAU,CAAE,CAAC8G,SAAS,CAClB,iFAAiF,CACjFtD,SAAS,CACbvD,SAAS,CAAE,CAACvF,QAAQ,CAChB,mCAAmC,CACnC8I,SACN,CACF,CAAE,CACFjD,OAAO,CAAEA,CAAA,GAAM,CAAC3F,UAAU,EAAImG,YAAY,CAAC2B,GAAG,CAAE,CAChDsD,QAAQ,CAAE,CAAC,CAACtL,QAAS,CAAAmF,QAAA,eAErB9F,KAAA,SAAMiN,KAAK,CAAE,CAAErC,QAAQ,CAAE,UAAU,CAAEM,MAAM,CAAE,CAAE,CAAE,CAAApF,QAAA,EAAEb,MAAM,CAACC,YAAY,CAAC,EAAE,CAAGyD,GAAG,CAAC,CAAC,IAAE,CAACzG,UAAU,CAAC0K,GAAG,CAAC,EAAO,CAAC,CAC1GG,SAAS,EAAID,UAAU,eACtBhN,IAAA,SAAMmN,KAAK,CAAE,CACXrC,QAAQ,CAAE,UAAU,CACpBK,KAAK,CAAE,EAAE,CACTF,GAAG,CAAE,KAAK,CACVc,SAAS,CAAE,kBAAkB,CAC7BtF,UAAU,CAAE,GAAG,CACf8E,QAAQ,CAAE,EAAE,CACZjF,KAAK,CAAE,SAAS,CAChBH,UAAU,CAAE+C,SAAS,CACjB,mDAAmD,CACnD,mDAAmD,CACvDhD,YAAY,CAAE,EAAE,CAChBkH,OAAO,CAAE,UAAU,CACnBhH,SAAS,CAAE,+BAA+B,CAC1CgF,MAAM,CAAE,CACV,CAAE,CAAApF,QAAA,CACCkD,SAAS,CAAG,SAAS,CAAG,UAAU,CAC/B,CACP,GA7DIL,GA8DC,CAAC,CAEb,CAAC,CAAC,cAEF7I,IAAA,CAACP,UAAU,EAAC6G,KAAK,CAAC,OAAO,CAACG,UAAU,CAAE,GAAI,CAACF,EAAE,CAAE,CAAE,CAAAP,QAAA,CAAC,mDAAyC,CAAY,CACxG,CACE,CAAC,CACLjF,UAAU,eACTb,KAAA,CAACX,GAAG,EAACmG,EAAE,CAAE,CAAEa,EAAE,CAAE,CAAE,CAAE,CAAAP,QAAA,eACjBhG,IAAA,CAACP,UAAU,EAAC6G,KAAK,CAAC,cAAc,CAACG,UAAU,CAAE,GAAI,CAACF,EAAE,CAAE,CAAE,CAAAP,QAAA,CACrDrD,cAAc,CAAC9B,QAAQ,EAAI,EAAE,CAAE0D,CAAC,CAACQ,OAAO,CAAC,CAAG,QAAQ,CAAG,gBAAgBgC,oBAAoB,CAAC,CAAC,EAAE,CACtF,CAAC,cACb/G,IAAA,CAACN,MAAM,EAAC8G,OAAO,CAAC,MAAM,CAACE,OAAO,CAAEA,CAAA,GAAMxF,kBAAkB,CAACkI,CAAC,EAAI,CAACA,CAAC,CAAE,CAAApD,QAAA,CAC/D/E,eAAe,CAAG,cAAc,CAAG,eAAe,CAC7C,CAAC,CACRA,eAAe,eACdjB,IAAA,CAACP,UAAU,EAACqH,EAAE,CAAE,CAAE,CAACR,KAAK,CAAC,gBAAgB,CAAAN,QAAA,CAAEzB,CAAC,CAAC8I,WAAW,CAAa,CACtE,EACE,CACN,CAEA,CAAC9L,WAAW,eACXrB,KAAA,CAACX,GAAG,EAACmG,EAAE,CAAE,CAAEG,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEC,cAAc,CAAE,CAAEgF,EAAE,CAAE,eAAe,CAAEC,EAAE,CAAE,QAAS,CAAC,CAAEU,GAAG,CAAE,GAAG,CAAE5E,EAAE,CAAE,CAAE,CAAE,CAAAd,QAAA,eACzHhG,IAAA,CAACN,MAAM,EACL8G,OAAO,CAAC,UAAU,CAClBE,OAAO,CAAEmE,YAAa,CACtBsB,QAAQ,CAAExL,OAAO,GAAK,CAAE,CACxB+E,EAAE,CAAE,CACFwH,aAAa,CAAE,MAAM,CACrBzG,UAAU,CAAE,GAAG,CACf6G,WAAW,CAAE,CAAC,CACdC,WAAW,CAAE,SAAS,CACtBjH,KAAK,CAAE,SAAS,CAChB,SAAS,CAAE,CAAEiH,WAAW,CAAE,SAAS,CAAEpH,UAAU,CAAE,sBAAuB,CAAC,CACzEN,OAAO,CAAE,CAAEkF,EAAE,CAAE,aAAa,CAAEC,EAAE,CAAE,MAAO,CAC3C,CAAE,CAAAhF,QAAA,CACH,WAED,CAAQ,CAAC,cACThG,IAAA,CAACN,MAAM,EACL8G,OAAO,CAAC,WAAW,CACnBE,OAAO,CAAE4C,YAAa,CACtB5D,EAAE,CAAE,CACFwH,aAAa,CAAE,MAAM,CACrBzG,UAAU,CAAE,GAAG,CACfP,YAAY,CAAE,CAAC,CACfmF,EAAE,CAAE,CAAC,CACLC,EAAE,CAAE,GAAG,CACPlF,SAAS,CAAE,CAAC,CACZD,UAAU,CAAE,mDAAmD,CAC/DG,KAAK,CAAE,MAAM,CACb,SAAS,CAAE,CAAEH,UAAU,CAAE,mDAAoD,CAC/E,CAAE,CAAAH,QAAA,CACH,OAED,CAAQ,CAAC,cACThG,IAAA,CAACN,MAAM,EACL8G,OAAO,CAAC,UAAU,CAClBE,OAAO,CAAEe,YAAa,CACtB0E,QAAQ,CAAExL,OAAO,GAAKJ,SAAS,CAAC+B,MAAM,CAAG,CAAE,CAC3CoD,EAAE,CAAE,CACFwH,aAAa,CAAE,MAAM,CACrBzG,UAAU,CAAE,GAAG,CACf6G,WAAW,CAAE,CAAC,CACdC,WAAW,CAAE,SAAS,CACtBjH,KAAK,CAAE,SAAS,CAChB,SAAS,CAAE,CAAEiH,WAAW,CAAE,SAAS,CAAEpH,UAAU,CAAE,sBAAuB,CAAC,CACzEN,OAAO,CAAE,CAAEkF,EAAE,CAAE,aAAa,CAAEC,EAAE,CAAE,MAAO,CAC3C,CAAE,CAAAhF,QAAA,CACH,SAED,CAAQ,CAAC,EACN,CACN,EACI,CACR,CAEAzE,WAAW,eACVvB,IAAA,CAACT,GAAG,EAACmG,EAAE,CAAE,CAAEoF,QAAQ,CAAE,OAAO,CAAEG,GAAG,CAAE,CAAC,CAAEa,IAAI,CAAE,CAAC,CAAEQ,KAAK,CAAE,OAAO,CAAEkB,MAAM,CAAE,OAAO,CAAE5H,OAAO,CAAE,oBAAoB,CAAEwF,MAAM,CAAE,IAAI,CAAEvF,OAAO,CAAE,MAAM,CAAEC,UAAU,CAAE,QAAQ,CAAEC,cAAc,CAAE,QAAS,CAAE,CAAAC,QAAA,cAC7L9F,KAAA,CAACX,GAAG,EAACmG,EAAE,CAAE,CAAEE,OAAO,CAAE,MAAM,CAAEM,YAAY,CAAE,CAAC,CAAEE,SAAS,CAAE,CAAC,CAAEH,CAAC,CAAE,CAAC,CAAEwH,QAAQ,CAAE,GAAG,CAAElB,QAAQ,CAAE,MAAM,CAAElG,SAAS,CAAE,QAAQ,CAAEyE,QAAQ,CAAE,UAAW,CAAE,CAAA9E,QAAA,eAC5IhG,IAAA,CAACP,UAAU,EAAC+G,OAAO,CAAC,IAAI,CAACC,UAAU,CAAE,GAAI,CAACH,KAAK,CAAC,SAAS,CAACC,EAAE,CAAE,CAAE,CAAAP,QAAA,CAAC,mBAAY,CAAY,CAAC,cAC1F9F,KAAA,CAACT,UAAU,EAAC8L,QAAQ,CAAE,EAAG,CAAC9E,UAAU,CAAE,GAAI,CAACH,KAAK,CAAC,SAAS,CAACC,EAAE,CAAE,CAAE,CAAAP,QAAA,EAAC,cAAO,CAAC7E,KAAK,EAAa,CAAC,cAC7FjB,KAAA,CAACT,UAAU,EAAC8L,QAAQ,CAAE,EAAG,CAAC9E,UAAU,CAAE,GAAI,CAACH,KAAK,CAAC,SAAS,CAACC,EAAE,CAAE,CAAE,CAAAP,QAAA,EAAC,oBAAQ,CAAC3E,QAAQ,EAAa,CAAC,cACjGnB,KAAA,CAACT,UAAU,EAAC8L,QAAQ,CAAE,EAAG,CAAC9E,UAAU,CAAE,GAAI,CAACH,KAAK,CAAC,SAAS,CAACC,EAAE,CAAE,CAAE,CAAAP,QAAA,EAAC,YAAK,CAACnE,OAAO,CAAC6L,MAAM,CAACC,MAAM,EAAIA,MAAM,GAAK,IAAI,EAAIA,MAAM,GAAKhE,SAAS,EAAIgE,MAAM,GAAK,EAAE,CAAC,CAACrL,MAAM,EAAa,CAAC,cAC/KpC,KAAA,CAACT,UAAU,EAAC8L,QAAQ,CAAE,EAAG,CAAC9E,UAAU,CAAE,GAAI,CAACH,KAAK,CAAC,SAAS,CAACC,EAAE,CAAE,CAAE,CAAAP,QAAA,EAAC,WAAM,CAAC2F,IAAI,CAACC,KAAK,CAACnK,IAAI,CAAG,EAAE,CAAC,CAAC,GAAC,CAAC,CAACA,IAAI,CAAG,EAAE,EAAEgC,QAAQ,CAAC,CAAC,CAACoI,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,EAAa,CAAC,cAEtJ7L,IAAA,CAACT,GAAG,EAACmG,EAAE,CAAE,CAAEG,OAAO,CAAE,MAAM,CAAE+H,QAAQ,CAAE,MAAM,CAAElC,GAAG,CAAE,CAAC,CAAE3F,cAAc,CAAE,QAAQ,CAAEQ,EAAE,CAAE,CAAE,CAAE,CAAAP,QAAA,CACrFzF,SAAS,CAAC+D,GAAG,CAAC,CAAC0F,QAAQ,CAAEnB,GAAG,GAAK,CAChC,KAAM,CAAAG,UAAU,CAAGnH,OAAO,CAACgH,GAAG,CAAC,CAC/B,KAAM,CAAAgF,YAAY,CAAG7E,UAAU,GAAK,IAAI,EAAIA,UAAU,GAAKW,SAAS,EAAIX,UAAU,GAAK,EAAE,CACzF,KAAM,CAAAE,SAAS,CAAG,CAAC2E,YAAY,EAAIlL,cAAc,CAACqG,UAAU,CAAEgB,QAAQ,CAACjF,OAAO,CAAC,CAE/E;AACA,GAAI,CAAAwI,WAAW,CAAEO,SAAS,CAAEC,eAAe,CAAEC,UAAU,CACvD,GAAIH,YAAY,CAAE,CAChB;AACAN,WAAW,CAAG,SAAS,CACvBO,SAAS,CAAG,SAAS,CACrBC,eAAe,CAAG,SAAS,CAC3BC,UAAU,CAAG,SAAS,CACxB,CAAC,IAAM,IAAI9E,SAAS,CAAE,CACpB;AACAqE,WAAW,CAAG,SAAS,CACvBO,SAAS,CAAG,SAAS,CACrBC,eAAe,CAAG,SAAS,CAC3BC,UAAU,CAAG,SAAS,CACxB,CAAC,IAAM,CACL;AACAT,WAAW,CAAG,SAAS,CACvBO,SAAS,CAAG,SAAS,CACrBC,eAAe,CAAG,SAAS,CAC3BC,UAAU,CAAG,SAAS,CACxB,CAEA,mBACEhO,IAAA,CAACN,MAAM,EAEL8G,OAAO,CAAC,UAAU,CAClBd,EAAE,CAAE,CACF+H,QAAQ,CAAE,EAAE,CACZD,MAAM,CAAE,EAAE,CACV/G,UAAU,CAAE,GAAG,CACf8E,QAAQ,CAAE,EAAE,CACZrF,YAAY,CAAE,CAAC,CACfuF,MAAM,CAAE,MAAM,CACdnF,KAAK,CAAE,SAAS,CAChBH,UAAU,CAAE,CAACtE,OAAO,CAACgH,GAAG,CAAC,CACrB,mDAAmD,CACnDK,SAAS,CACP,mDAAmD,CACnD,mDAAmD,CACzDsC,cAAc,CAAE,YAAY,CAC5BpF,SAAS,CAAE,gCAAgC,CAC3C6H,EAAE,CAAE,GAAG,CACPC,EAAE,CAAE,GAAG,CACPhC,UAAU,CAAE,eAAe,CAC3B,SAAS,CAAE,CACTH,SAAS,CAAE,kBAAkB,CAC7B3F,SAAS,CAAE,+BACb,CACF,CAAE,CACFM,OAAO,CAAEA,CAAA,GAAM,CACb9E,aAAa,CAAC,IAAI,CAAC,CACnBJ,cAAc,CAAC,KAAK,CAAC,CACrBZ,UAAU,CAACiI,GAAG,CAAC,CACf/H,WAAW,CAACe,OAAO,CAACgH,GAAG,CAAC,EAAI,IAAI,CAAC,CACjC7H,aAAa,CAAC,CAAC,CAACa,OAAO,CAACgH,GAAG,CAAC,CAAC,CAC7B3H,kBAAkB,CAAC,KAAK,CAAC,CAC3B,CAAE,CAAA8E,QAAA,CAED6C,GAAG,CAAG,CAAC,EAlCHA,GAmCC,CAAC,CAEb,CAAC,CAAC,CACC,CAAC,cACN7I,IAAA,CAACP,UAAU,EAAC8L,QAAQ,CAAE,EAAG,CAACjF,KAAK,CAAC,SAAS,CAACC,EAAE,CAAE,CAAE,CAAAP,QAAA,CAAC,yIAEjD,CAAY,CAAC,cAEb9F,KAAA,CAACX,GAAG,EAACmG,EAAE,CAAE,CAAEG,OAAO,CAAE,MAAM,CAAEE,cAAc,CAAE,QAAQ,CAAE2F,GAAG,CAAE,CAAC,CAAE5E,EAAE,CAAE,CAAC,CAAE8G,QAAQ,CAAE,MAAO,CAAE,CAAA5H,QAAA,eACtFhG,IAAA,CAACN,MAAM,EACL8G,OAAO,CAAC,WAAW,CACnBF,KAAK,CAAC,SAAS,CACfZ,EAAE,CAAE,CAAEe,UAAU,CAAE,GAAG,CAAE8E,QAAQ,CAAE,EAAE,CAAErF,YAAY,CAAE,CAAC,CAAEmF,EAAE,CAAE,CAAC,CAAEC,EAAE,CAAE,GAAG,CAAElF,SAAS,CAAE,CAAC,CAAE8G,aAAa,CAAE,MAAO,CAAE,CAC5GxG,OAAO,CAAEwD,gBAAiB,CAAAlE,QAAA,CAC3B,sBAED,CAAQ,CAAC,cACThG,IAAA,CAACN,MAAM,EACL8G,OAAO,CAAC,UAAU,CAClBF,KAAK,CAAC,SAAS,CACfZ,EAAE,CAAE,CAAEe,UAAU,CAAE,GAAG,CAAE8E,QAAQ,CAAE,EAAE,CAAErF,YAAY,CAAE,CAAC,CAAEmF,EAAE,CAAE,CAAC,CAAEC,EAAE,CAAE,GAAG,CAAElF,SAAS,CAAE,CAAC,CAAE8G,aAAa,CAAE,MAAO,CAAE,CAC5GxG,OAAO,CAAEA,CAAA,GAAM,CACbpG,QAAQ,CAAC,aAAa,CAAC,CACzB,CAAE,CAAA0F,QAAA,CACH,OAED,CAAQ,CAAC,cACThG,IAAA,CAACN,MAAM,EACL8G,OAAO,CAAC,WAAW,CACnBF,KAAK,CAAC,SAAS,CACfZ,EAAE,CAAE,CAAEe,UAAU,CAAE,GAAG,CAAE8E,QAAQ,CAAE,EAAE,CAAErF,YAAY,CAAE,CAAC,CAAEmF,EAAE,CAAE,CAAC,CAAEC,EAAE,CAAE,GAAG,CAAElF,SAAS,CAAE,CAAC,CAAE8G,aAAa,CAAE,MAAO,CAAE,CAC5GxG,OAAO,CAAEA,CAAA,GAAM,CACbuD,kBAAkB,CAAC,CAAC,CACtB,CAAE,CAAAjE,QAAA,CACH,kBAED,CAAQ,CAAC,EACN,CAAC,CAEL,CAAC8B,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,eAC7B/H,IAAA,CAACP,UAAU,EACT+G,OAAO,CAAC,SAAS,CACjBd,EAAE,CAAE,CACFG,OAAO,CAAE,OAAO,CAChBQ,SAAS,CAAE,QAAQ,CACnBS,EAAE,CAAE,CAAC,CACLyE,QAAQ,CAAE,SAAS,CACnBjF,KAAK,CAAE,MAAM,CACb6H,SAAS,CAAE,QACb,CAAE,CAAAnI,QAAA,CACH,uGAED,CAAY,CACb,EACE,CAAC,CACH,CACN,CACArE,UAAU,eACTzB,KAAA,CAACV,KAAK,EACJ4M,SAAS,CAAE,CAAE,CACb1G,EAAE,CAAE,CACFO,CAAC,CAAE,CAAC,CACJC,YAAY,CAAE,CAAC,CACfuH,QAAQ,CAAE,GAAG,CACblB,QAAQ,CAAE,GAAG,CACbD,KAAK,CAAE,MAAM,CACbnG,UAAU,CAAE,gFAAgF,CAC5FqF,cAAc,CAAE,YAAY,CAC5BC,MAAM,CAAE,oCAAoC,CAC5CrF,SAAS,CAAE,gCAAgC,CAC3C8F,UAAU,CAAE,qBAAqB,CACjC,SAAS,CAAE,CACTH,SAAS,CAAE,kBACb,CACF,CAAE,CAAA/F,QAAA,eAEFhG,IAAA,CAACT,GAAG,EAACmG,EAAE,CAAE,CAAEG,OAAO,CAAE,MAAM,CAAEE,cAAc,CAAE,QAAQ,CAAED,UAAU,CAAE,QAAQ,CAAES,EAAE,CAAE,CAAE,CAAE,CAAAP,QAAA,cAClF9F,KAAA,CAACT,UAAU,EACT+G,OAAO,CAAC,IAAI,CACZC,UAAU,CAAE,GAAI,CAChBI,KAAK,CAAC,QAAQ,CACdnB,EAAE,CAAE,CACFS,UAAU,CAAE,mDAAmD,CAC/DqG,cAAc,CAAE,MAAM,CACtBC,oBAAoB,CAAE,MAAM,CAC5BC,mBAAmB,CAAE,aAAa,CAClCC,UAAU,CAAE,8BACd,CAAE,CAAA3G,QAAA,EACH,OACM,CAACrF,OAAO,CAAG,CAAC,CAAC,KAAG,CAACJ,SAAS,CAAC+B,MAAM,CAAC,kBACzC,EAAY,CAAC,CACV,CAAC,cACNtC,IAAA,CAACP,UAAU,EACT+G,OAAO,CAAC,IAAI,CACZD,EAAE,CAAE,CAAE,CACNb,EAAE,CAAE,CACFY,KAAK,CAAE,SAAS,CAChBG,UAAU,CAAE,GAAG,CACf8E,QAAQ,CAAE,QAAQ,CAClBqB,UAAU,CAAE,GAAG,CACfvG,SAAS,CAAE,QAAQ,CACnB+G,OAAO,CAAE,MAAM,CACfjH,UAAU,CAAE,0BAA0B,CACtCD,YAAY,CAAE,MAAM,CACpBuF,MAAM,CAAE,kCACV,CAAE,CAAAzF,QAAA,CAEDzB,CAAC,CAAClC,IAAI,CACG,CAAC,cACbrC,IAAA,CAACT,GAAG,EAACmG,EAAE,CAAE,CAAEG,OAAO,CAAE,MAAM,CAAEgH,aAAa,CAAE,QAAQ,CAAEnB,GAAG,CAAE,CAAC,CAAEnF,EAAE,CAAE,CAAE,CAAE,CAAAP,QAAA,CAClErB,OAAO,CAACrC,MAAM,CAAG,CAAC,CACjBqC,OAAO,CAACL,GAAG,CAAC,CAACwI,GAAG,CAAEjE,GAAG,GAAK,CACxB,KAAM,CAAAkE,YAAY,CAAG5H,MAAM,CAACC,YAAY,CAAC,EAAE,CAAGyD,GAAG,CAAC,CAAE;AACpD,KAAM,CAAAmE,UAAU,CAAGnL,OAAO,CAAClB,OAAO,CAAC,GAAKoM,YAAY,CACpD,KAAM,CAAA7D,SAAS,CAAGvG,cAAc,CAACoK,YAAY,CAAExI,CAAC,CAACQ,OAAO,CAAC,CACzD,KAAM,CAAAkI,SAAS,CAAG,CAAC,CAACpL,OAAO,CAAClB,OAAO,CAAC,CACpC,mBACET,KAAA,CAACR,MAAM,EAEL8G,OAAO,CAAEwG,UAAU,CAAG,WAAW,CAAG,UAAW,CAC/C1G,KAAK,CAAE2G,SAAS,CAAI/D,SAAS,CAAG,SAAS,CAAG8D,UAAU,CAAG,OAAO,CAAG,SAAS,CAAI,SAAU,CAC1FtH,EAAE,CAAE,CACFW,SAAS,CAAE,MAAM,CACjBI,UAAU,CAAE,GAAG,CACf8E,QAAQ,CAAE,EAAE,CACZrF,YAAY,CAAE,CAAC,CACfoF,EAAE,CAAE,CAAC,CACLD,EAAE,CAAE,CAAC,CACLlF,UAAU,CAAE,CAAC8G,SAAS,CAClB,+EAA+E,CAC/ED,UAAU,CACP9D,SAAS,CACN,mDAAmD,CACnD,mDAAmD,CACtDA,SAAS,CACN,iFAAiF,CACjF,+EAAgF,CAC1F5C,KAAK,CAAE2G,SAAS,EAAID,UAAU,CAAG,SAAS,CAAG9D,SAAS,EAAI+D,SAAS,CAAG,SAAS,CAAG,SAAS,CAC3FxB,MAAM,CAAEvC,SAAS,EAAI+D,SAAS,EAAI,CAACD,UAAU,CACzC,mBAAmB,CACnBC,SAAS,EAAID,UAAU,CACrB,MAAM,CACN,kCAAkC,CACxCxB,cAAc,CAAE,YAAY,CAC5BpF,SAAS,CAAE4G,UAAU,CACjB,mCAAmC,CACnC9D,SAAS,EAAI+D,SAAS,CACpB,mCAAmC,CACnC,+BAA+B,CACrCnC,QAAQ,CAAE,UAAU,CACpBoB,UAAU,CAAE,eAAe,CAC3BkC,aAAa,CAAE,MACjB,CAAE,CACFjC,QAAQ,MAAAnG,QAAA,eAER9F,KAAA,SAAMiN,KAAK,CAAE,CAAErC,QAAQ,CAAE,UAAU,CAAEM,MAAM,CAAE,CAAE,CAAE,CAAApF,QAAA,EAAEb,MAAM,CAACC,YAAY,CAAC,EAAE,CAAGyD,GAAG,CAAC,CAAC,IAAE,CAACiE,GAAG,EAAO,CAAC,CAC9FG,SAAS,EAAID,UAAU,eACtBhN,IAAA,SAAMmN,KAAK,CAAE,CACXrC,QAAQ,CAAE,UAAU,CACpBK,KAAK,CAAE,EAAE,CACTF,GAAG,CAAE,KAAK,CACVc,SAAS,CAAE,kBAAkB,CAC7BtF,UAAU,CAAE,GAAG,CACf8E,QAAQ,CAAE,EAAE,CACZjF,KAAK,CAAE4C,SAAS,CAAG,SAAS,CAAG,SAAS,CACxC/C,UAAU,CAAE+C,SAAS,CAAG,SAAS,CAAG,SAAS,CAC7ChD,YAAY,CAAE,CAAC,CACfkH,OAAO,CAAE,UAAU,CACnBhH,SAAS,CAAE,iCAAiC,CAC5CgF,MAAM,CAAE,CACV,CAAE,CAAApF,QAAA,CACCkD,SAAS,CAAG,OAAO,CAAG,QAAQ,CAC3B,CACP,GAvDIL,GAwDC,CAAC,CAEb,CAAC,CAAC,cAEF7I,IAAA,CAACP,UAAU,EAAC6G,KAAK,CAAC,OAAO,CAACG,UAAU,CAAE,GAAI,CAACF,EAAE,CAAE,CAAE,CAAAP,QAAA,CAAC,mDAAyC,CAAY,CACxG,CACE,CAAC,CAEL,CAAC,CAACzB,CAAC,CAAC8I,WAAW,eACdnN,KAAA,CAACX,GAAG,EAACmG,EAAE,CAAE,CAAEa,EAAE,CAAE,CAAE,CAAE,CAAAP,QAAA,eACjBhG,IAAA,CAACN,MAAM,EAAC8G,OAAO,CAAC,MAAM,CAACE,OAAO,CAAEA,CAAA,GAAMxF,kBAAkB,CAACkI,CAAC,EAAI,CAACA,CAAC,CAAE,CAAApD,QAAA,CAC/D/E,eAAe,CAAG,cAAc,CAAG,eAAe,CAC7C,CAAC,CACRA,eAAe,eACdjB,IAAA,CAACP,UAAU,EAACqH,EAAE,CAAE,CAAE,CAACR,KAAK,CAAC,gBAAgB,CAAAN,QAAA,CAAEzB,CAAC,CAAC8I,WAAW,CAAa,CACtE,EACE,CACN,cACDrN,IAAA,CAACT,GAAG,EAACmG,EAAE,CAAE,CAAEG,OAAO,CAAE,MAAM,CAAEE,cAAc,CAAE,QAAQ,CAAEe,EAAE,CAAE,CAAE,CAAE,CAAAd,QAAA,cAC5DhG,IAAA,CAACN,MAAM,EACL8G,OAAO,CAAC,UAAU,CAClBF,KAAK,CAAC,SAAS,CACfZ,EAAE,CAAE,CAAEe,UAAU,CAAE,GAAG,CAAE8E,QAAQ,CAAE,EAAE,CAAErF,YAAY,CAAE,CAAC,CAAEmF,EAAE,CAAE,CAAC,CAAEC,EAAE,CAAE,GAAG,CAAElF,SAAS,CAAE,CAAC,CAAE8G,aAAa,CAAE,MAAO,CAAE,CAC5GxG,OAAO,CAAEA,CAAA,GAAM,CACb9E,aAAa,CAAC,KAAK,CAAC,CACpBJ,cAAc,CAAC,IAAI,CAAC,CACpBN,kBAAkB,CAAC,KAAK,CAAC,CAC3B,CAAE,CAAA8E,QAAA,CACH,qBAED,CAAQ,CAAC,CACN,CAAC,EACD,CACR,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAA7F,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}